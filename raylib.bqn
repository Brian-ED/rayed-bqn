## Conventions:
# One big goal of this lib is to eliminate as many bugs of raylib as possible,
# for example, opening the window twice is impossible because it is not intended in raylib, and causes many bugs.

# x and y as variables (also x1 y1, x2 y2 etc) are always positions

# -------
# Exports
âŸ¨draw, texture, monitor, window, mouse
 font, key, utils, clipboardâŸ©â‡

âŸ¨
  traceLogLevel
  gamepadButton, gamepadAxis
  materialMapIndex
  shaderLocationIndex, shaderUniformDataType, shaderAttributeDataType
  pixelFormat
  textureFilter, textureWrap
  cubemapLayout
  fontType
  blendMode
  gesture
  cameramode, cameraProjection
  nPatchLayout
  color
âŸ© â‡ âŸ¨
  bqnFontChars
  windowConfigFlags
âŸ© â† â€¢Import "src/constants.bqn"

global â† â€¢Import "src/global.bqn"
NeedsWindow â† {window.isOpen?ğ•©;!"Expected window to be open"}
global.SetNeedsWindow needsWindow

âŸ¨bqnLibsPathâŸ© â† â€¢Import "src/loadConfig.bqn"
rayFFI  â‡ â€¢Import "rayffi.bqn"
raymath â‡ â€¢Import "src/raymath.bqn"
image   â‡ â€¢Import "src/image.bqn"
# -------

# Utils:
FileAt â† "/cygdrive/c"("C:"âˆ¾â‰ âŠ¸â†“)âŸ(âŠ£â‰¡â‰ âŠ¸â†‘)â€¢file.At                # remade â€¢FileAt to work for cygwin

# Defaults
rayffi.SetTraceLogLevel traceLogLevel.warning # makes logs not output INFO: logs to stdOut

# constants
i32_max â† Â¯1+2â‹†31

texture â† {
  Load â‡ {ğ•ŠstrPath: # Load texture from file into GPU memory (VRAM)
    NeedsWindow@
    !â€¢file.Exists ğ•©
    rayFFI.LoadTexture ğ•©
  }
  Unload â‡ {ğ•Štexture: NeedsWindow@ â‹„ @âŠ£rayFFI.UnloadTextureğ•©}
  _with â‡ {ğ”½_ğ•£ strPath : (UnloadâŠ¢ğ”½)Loadğ•©}
  _WithImage â‡ {
    NeedsWindow@
    (UnloadâŠ¢ğ”½)rayffi.LoadTextureFromImage image._AsRayImg ğ•©
  }
}
monitor â† {
  âŸ¨Selected â‹„ Count
   RefreshRate â‹„ Size
   Sizemm â‹„ NameâŸ©â‡
  Selected    â† rayFFI.GetCurrentMonitorâˆ˜âŸ¨âŸ©NeedsWindow
  Count       â† rayFFI.GetMonitorCountâˆ˜âŸ¨âŸ©NeedsWindow

  notAMonitorErr â† "Invalid monitor ğ•©, can only be @ for currently selected monitor or a monitor number; ( ğ•©âˆŠâ†•monitor.Count@ ) v ( ğ•©â‰¡@ )"
  M â† @âŠ¸â‰¢â—¶Selectedâ€¿{ğ•©âŠ£notAMonitorErr!âŠ‘ğ•©âˆŠâ†•Count@} # No need for NeedsWindow because Selected and Count need it so error still works

  RefreshRate â† rayFFI.GetMonitorRefreshRate M
  Size        â† (rayFFI.GetMonitorWidth âˆ¾ rayFFI.GetMonitorHeight)M
  Sizemm      â† (rayFFI.GetMonitorPhysicalWidth âˆ¾ rayFFI.GetMonitorPhysicalHeight)M # mm stands for milimeter
  Name        â† rayFFI.GetMonitorName M
}

# window functionality
window â† {
  âŸ¨
    isOpen â‹„ _openAs â‹„ SetIcon â‹„ fps â‹„ GetSize
    ShouldClose â‹„ Needed â‹„ SetPos â‹„ GetPos â‹„ SetSize â‹„ configFlags

    fullscreen        â‹„ SetFullscreen
    resizable         â‹„ SetResizable
    decorated         â‹„ SetDecorated
    transparent       â‹„ SetTransparent
    msaa4xhint        â‹„ Setmsaa4xhint
    vsyncHint         â‹„ Setvsynchint
    hidden            â‹„ SetHidden
    runWhileMinimized â‹„ SetRunWhileMinimized
    minimized         â‹„ SetMinimized
    maximized         â‹„ SetMaximized
    focused           â‹„ SetFocused
    topmost           â‹„ SetTopmost
    highDPI           â‹„ SetHighDPI
    mousePassThrough  â‹„ SetMousePassThrough
    interlacedhint    â‹„ SetInterlacedhint

    GetState # get binary list of above settings (including empty ones in the raylib binary format)
  âŸ©â‡

  Needed â† NeedsWindow
  isOpen â† 0

  # Get the xâ€¿y position of the window   (relative to current monitor?)
  GetPos â† {rayffi.GetWindowPositionâŸ¨âŸ©âŠ£NeedsWindowğ•©}
  
  # Set the xâ€¿y position of the window   (relative to current monitor?)
  SetPos â† {rayFFI.SetWindowPosition NeedsWindowğ•©}

  # tempSize is used to store size until window is open
  tempSize â† 0â€¿0

  # Set the width and hight of the window, width and hight being relative to window position
  SetSize â† {ğ•Šsize:
    ((âŒˆâŠ¸â‰¡âˆ¨âŠ¢â‰¡0âŒˆ1âŒŠâŠ¢)ğ•©)!Ëœ"Size can only be between 0 and 1, or a positive whole number"
    ((âŸ¨âŸ©âŠ¸â‰¡âˆ¨âŸ¨2âŸ©âŠ¸â‰¡)â‰¢ğ•©)!Ëœ"Size can be a scaler (âŸ¨âŸ©â‰¢â‰¢ğ•¨) or length two list (âŸ¨2âŸ©â‰¡â‰¢ğ•¨)"
    isOpen?
      s â† (rayFFI.GetMonitorWidth âˆ¾ rayFFI.GetMonitorHeight) rayFFI.GetCurrentMonitorâŸ¨âŸ©
      f â† (1âŠ¸>âˆ§0âŠ¸â‰¤)ğ•©
      # if given size is 0-1, scale the window relative to monitor size
      rayFFI.SetWindowSize âŒˆ2â¥ŠsÃ—âŸœÂ¬âŒ¾(fâŠ¸/)2â¥Šğ•©
  ;
    tempSizeâ†©ğ•©
  }
  
  # Get the width and hight of the window, width and hight being relative to window position
  GetSize â† {ğ•¤
    isOpen?
      âŸ¨rayFFI.GetScreenWidthâŸ¨âŸ©
       rayFFI.GetScreenHeightâŸ¨âŸ©âŸ©
  ;
    tempSize
  }

  # Open the window with default settings
  Open â† {ğ•Š title:
    (Â¬isOpen)!Ëœ"The window cannot be opened twice"
    rayFFI.InitWindow 0â€¿0â€¿ğ•©
    rayFFI.SetWindowPositionâŸ("windows"â‰¡â€¢platform.os) 0â€¿42 # 42 here is the window header on windows only

    binaryâ†GetState@
    rayffi.SetWindowState 2âŠ¸Ã—âŠ¸+ËœÂ´ binary

    isOpenâ†©1

    SetSize tempSize

    rayffi.SetExitKey 0 # 0 means no key, essentially removing esc key closing programs implicitly
    rayFFI.SetWindowPositionâŸ("windows"â‰¡â€¢platform.os) 0â€¿42 # 42 here is the window header on windows only
    # Setting fps to the refresh rate of the currently selected monitor
    fps.Set rayFFI.GetMonitorRefreshRate rayFFI.GetCurrentMonitorâŸ¨âŸ©
  }
  ShouldClose â† rayFFI.WindowShouldCloseâŸ¨âŸ©âŠ£NeedsWindow
  Close â† {
    NeedsWindow@
    rayFFI.CloseWindowâŸ¨âŸ©
    ğ•©âŠ£isOpenâ†©0
  }
  _openAs â† {App _ğ•£ title: sizeâ†ğ•¨âŠ£1
    Open ğ•©
    CloseâŠ¸âŠ¢ğ”½ {startTimeâ‡â€¢Monotime@} 
  }
  # TODO: Needs to test input for image
  SetIcon â† {ğ•Šimage: NeedsWindow@ â‹„ rayFFI.SetWindowIconğ•©} image._AsRayImg

  fps â† {
    Get â‡ rayFFI.GetFPSâŸ¨âŸ©âŠ£NeedsWindow
    Set â‡ {
      (ğ•©=0âŒˆâŒˆğ•©)!Ëœ"FPS has to be a positive int"
      ğ•©âŠ£rayFFI.SetTargetFPSğ•©
    }âŠ£NeedsWindow
  }
  configFlags â† windowConfigFlags

  fullscreen        â† 0 # Set to run program in fullscreen
  resizable         â† 1 # Set to allow resizable window
  decorated         â† 1 # Set to 0 to disable window decoration (frame and buttons)
  transparent       â† 0 # Set to allow transparent framebuffer
  msaa4xhint        â† 0 # Set to try enabling MSAA 4X
  vsyncHint         â† 0 # Set to try enabling V-Sync on GPU
  hidden            â† 0 # Set to hide window
  runWhileMinimized â† 0 # Set to allow windows running while minimized
  minimized         â† 0 # Set to minimize window (iconify)
  maximized         â† 0 # Set to maximize window (expanded to monitor)
  focused           â† 1 # Set to 0 to non focus window
  topmost           â† 0 # Set to window always on top
  highDPI           â† 0 # Set to support HighDPI
  mousePassThrough  â† 0 # Set to support mouse passthrough, only supported when FLAG_WINDOW_UNDECORATED
  interlacedhint    â† 0 # Set to try enabling interlaced video format (for V3D)

  cf â† configFlags
  cs â† { # array of Clearâ€¿Set that clears(Clear sets var to 0) and sets(Set var to 1) used as â—¶cs
    âŸ¨Clearâ‡ClearWindowState, Setâ‡SetWindowStateâŸ© â† rayffi
    Clearâ€¿Set
  }
  
  SetFullscreen        â‡ { fullscreen        â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.fullscreen_mode          }
  SetResizable         â‡ { resizable         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_resizable         }
  SetDecorated         â‡ { decorated         â†© ğ•© âŠ£ Â¬âˆ˜ğ•©â—¶csâŸisOpen cf.window_undecorated       }
  SetTransparent       â‡ { transparent       â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_transparent       }
  Setmsaa4xhint        â‡ { msaa4xhint        â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.msaa4xhint               }
  Setvsynchint         â‡ { vsyncHint         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.vsync_hint               }
  SetHidden            â‡ { hidden            â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_hidden            }
  SetRunWhileMinimized â‡ { runWhileMinimized â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_always_run        }
  SetMinimized         â‡ { minimized         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_minimized         }
  SetMaximized         â‡ { maximized         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_maximized         }
  SetFocused           â‡ { focused           â†© ğ•© âŠ£ Â¬âˆ˜ğ•©â—¶csâŸisOpen cf.window_unfocused         }
  SetTopmost           â‡ { topmost           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_topmost           }
  SetHighDPI           â‡ { highDPI           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.highDPI                  }
  SetMousePassThrough  â‡ { topmost           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_mouse_passthrough }
  SetInterlacedhint    â‡ { interlacedhint    â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_interlacedhint    }
  
  names â† [
    "                 "
    "fullscreen       "
    "resizable        "
    "undecorated      "
    "transparent      "
    "msaa4xhint       "
    "vsyncHint        "
    "hidden           "
    "runWhileMinimized"
    "minimized        "
    "maximized        "
    "unfocused        "
    "topmost          "
    "highDPI          "
    "mousePassThrough "
    "interlacedhint   "
    "interlacedhint   "
  ]
  GetState â† {ğ•¤ # returns binary list that corrisponds to raylib's config_flags format
    0â€¿fullscreenâ€¿resizableâ€¿(Â¬decorated)â€¿transparentâ€¿msaa_4x_hintâ€¿vsync_hintâ€¿hiddenâ€¿runWhileMinimizedâ€¿minimizedâ€¿maximizedâ€¿(Â¬focused)â€¿topmostâ€¿highdpiâ€¿mouse_passthroughâ€¿0â€¿interlaced_hint
  }
  GetFmtState â† names<âŠ¸âˆ¾Ë˜GetState
}

# Drawing
draw â† {
  âŸ¨
    _withCanvas_ â‹„ _in3D
    Rectangle â‹„ Triangle â‹„ Line
    Ellipse â‹„ EllipseOutline
    Text â‹„ Texture â‹„ advanced
  âŸ©â‡

  # Start 3d mode, drawing relative to camera using ğ”½, then ends 3d mode
  _in3D â† {ğ•¨ Drawing3D _ğ•£ camera:
    NeedsWindow@          # pos  target up   FOV Camera projection type
    "_in3D: wrong types as input"!ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iii"â€¿"iii"â€¿"iii"â€¿'i'â€¿'i'
    rayffi.BeginMode3D ğ•©
    rayffi.EndMode3Dâˆ˜âŸ¨âŸ©âŠ¸âŠ¢ğ”½ğ•©
  }

  # Draw background
  Background â† {ğ•Šrâ€¿gâ€¿bâ€¿a:
    NeedsWindow@
    (âˆ§Â´(255âŠ¸â‰¥âˆ§>0âŠ¸â‰¤)ğ•©)!Ëœ"ClearBackground only accepts ints in the range 0-255 inclusive"
    "Background: wrong types as input"!ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iiii"
    rayFFI.ClearBackground ğ•©
  }

  # Start Drawing
  Start â† âŠ¢âŠ£rayFFI.BeginDrawingâˆ˜âŸ¨âŸ©âŠ£NeedsWindow

  # End drawing
  End â† âŠ¢âŠ£rayFFI.EndDrawingâˆ˜âŸ¨âŸ©âŠ£NeedsWindow

  # Start drawing, draw background, use function ğ”½, end drawing
  _withCanvas_ â† {ğ•¨DrawingFunc _ğ•£_ Func_Returning_A_Colorğ•©:
    Start@
    Background ğ•¨ğ”¾ğ•©
    âŠ£âŸœEndğ•¨ğ”½ğ•©
  }

  # Draw text at xâ€¿y in given font, color, and size
  Text â† {ğ•¨ğ•ŠâŸ¨xâ€¿yâ‹„textâŸ©:
    NeedsWindow@
    tâ†âŸ¨râ€¿gâ€¿bâ€¿aâ‹„fontâ‹„fontSizeâ‹„spacingâŸ© â‡ âˆ¾âŸœ1âŸ(3â‰¡â‰ )ğ•¨
    "Text: wrong types as input"!tâ€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿("iii"âˆ¾5â€¿8â€¿8â¥ŠÂ¨'i')â€¿'i'â€¿'i'â‹„"ii"â‹ˆ'c'Â¨textâŸ©
    rayFFI.DrawTextCodepoints âŸ¨fontâ‹„text-@â‹„â‰ textâ‹„xâ€¿yâ‹„fontSizeâ‹„spacingâ‹„râ€¿gâ€¿bâ€¿aâŸ©
  }

  # Draw line from x1â€¿y1 to x2â€¿y2
  Line â† {ğ•¨ğ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    leftArgâ†{
      ğ•Šrâ€¿gâ€¿bâ€¿a:1â‹ˆËœğ•©;
      ğ•ŠâŸ¨râ€¿gâ€¿bâ€¿aâ‹„thicknessâŸ©:ğ•©
    }ğ•¨
    "Line: wrong types as input"!leftArgâ€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿'i'â‹„2â€¿2â¥Š'i'âŸ©
    rayFFI.DrawLineEx(<Ë˜ğ•©)âˆ¾âŒ½leftArg
  }

  Texture â† {âŸ¨râ€¿gâ€¿bâ€¿aâ‹„textureâ‹„scaleâ‹„rotationâŸ© ğ•Š xâ€¿y:
    NeedsWindow@
    "Texture: wrong types as input"!ğ•¨â€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿"iiiii"â€¿'i'â€¿'i'â‹„"ii"âŸ©
    rayFFI.DrawTextureEx âŸ¨textureâ‹„xâ€¿yâ‹„rotationâ‹„scaleâ‹„râ€¿gâ€¿bâ€¿aâŸ© # textureâ€¿v2â€¿fâ€¿fâ€¿color # texture position rotation scale tint
  }

  Rectangle â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    "Rectangle: wrong types as input"!ğ•¨â€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iiii"â‹ˆ2â€¿2â¥Š'i'
    rayFFI.DrawRectangleV ğ•¨âˆ¾âŸœ<Ëœ(âŠ£â‹ˆ-Ëœ)Ëâˆ§Ë˜âŒ¾â‰i32_maxâŒŠ0âŒˆâŒŠğ•© # capping with max and min to avoid errors at âˆ
  }

  Ellipse â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    ((âˆ§Â´âŒˆâŠ¸=âˆ¨âˆ=|)ğ•¨âˆ¾â¥Šğ•©)!Ëœ"Ellipse only accepts ints as args"
    (âˆ§Â´ğ•¨âˆŠâ†•256)!Ëœ"ğ•— (color) only accepts ints in the range 0-255 inclusive"
    rayffi.DrawEllipse ğ•¨âˆ¾âŸœ<Ëœ(âŒˆâˆ¾âŠ¢-âŠâˆ˜ğ•©)(+ËÃ·â‰ )ğ•©
  }

  EllipseOutline â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    rayffi.DrawEllipseLines ğ•¨âˆ¾âŸœ<Ëœ(âŒˆâˆ¾âŠ¢-âŠâˆ˜ğ•©)(+ËÃ·â‰ )ğ•©                # iâ€¿iâ€¿fâ€¿fâ€¿color # centerX centerY radiusH radiusV
  }

  Triangle â† {colorğ•Š[x1â€¿y1â‹„x2â€¿y2â‹„x3â€¿y3]:
    [p1,p2,p3]â† ğ•©
    rayffi.DrawTriangle âŸ¨p1,ğ•¨âŸ©âˆ¾Ëœp2â€¿p3âŒ½Ëœp3<â—‹(â€¢math.Atan2Â´p2âŠ¸-)p1
  }

  # These aren't recommended because they are useless if you use _withCanvas_.
  # They also don't behave well if ran in the wrong order,
  # you only want to run them in the "start, background, end" sequence.
  advanced â‡ {Startâ€¿Backgroundâ€¿Endâ‡Startâ€¿Backgroundâ€¿End}
}

font â† {
  âŸ¨ Load â‹„ LoadBQN â‹„ LoadRaylib â‹„ Unload âŸ©â‡
  IsFont â† {
    (ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iii"âˆ¾"iiiii"<âŠ¸âˆ¾â‹ˆËœ8â¥Š'i')!Ëœ"Expected a valid font"   # Type info can be found in rayffi.bqn https://github.com/Brian-ED/rayed-bqn/blob/1ccf239c9167307c36bcd882c7f1031640f67032/rayffi.bqn#L81
    ğ•©âŠ£(Â¬âˆ¨Â´âˆ§Â´Â¨0=Â¯2â†‘ğ•©)!Ëœ"Invalid font. font has null pointers, making it invalid"
  }
  glyphInfoâ†{valueâ€¿offsetXâ€¿offsetYâ€¿advanceXâ€¿imageâ‡â†•5}             # The namespace is for eliminating magic-numbers

  Unload â† rayFFI.UnloadFontâˆ˜IsFont NeedsWindow

  Load â† {
    NeedsWindow@
    Fâ†{
      ğ•Šsizeâ€¿filePath:
        âŸ¨filePathâ‹„sizeâ‹„â‰@â‹„0âŸ©
    ;                                           # fontSize fontChars glyphCount # use NULL for fontChars and 0 for glyphCount to load the default character set
      charactersAllowed ğ•Š sizeâ€¿filePath:
        âŸ¨filePathâ‹„sizeâ‹„ğ•¨-@â‹„â‰ ğ•¨âŸ©
    }
    fontArgsâ†ğ•¨Fğ•©
    IsFont rayFFI.LoadFontEx fontArgs
  }

  LoadBQN â† {ğ•ŠfontSize:
    NeedsWindow@
    rayFFI.LoadFontExâŸ¨FileAt"src/BQN386.ttf"â‹„100âŸ(@âŠ¸â‰¡)ğ•©â‹„bqnFontChars-@â‹„â‰ bqnFontCharsâŸ©
  }
  LoadRaylib â† rayffi.GetFontDefaultâˆ˜âŸ¨âŸ©
}
clipboard â† {
  âŸ¨ToBytesâŸ© â† â€¢Import bqnLibsPathâˆ¾"/strings.bqn"
  Get â‡ rayffi.MakeUTF8 rayffi.StrLenâŠ¸â‹ˆâˆ˜rayffi.GetClipboardTextâˆ˜âŸ¨âŸ©
  Set â‡ rayffi.SetClipboardText ToBytesâŠ£NeedsWindow
}
utils â† {
  âŸ¨_FromCenterâ‹„_bitwiseâŸ©â‡
  _FromCenter â† {câ†(+ËÃ·â‰ )Ë˜ğ•©â‹„ğ”½âŒ¾(-âŸœc)ğ•©}                             # example of ğ•©: [x1â€¿x2â€¿x3â‹„y1â€¿y2â€¿y3â‹„z1â€¿z2â€¿z3]
  _bitwise â† {2âŠ¸Ã—âŠ¸+ËœÂ´ğ•¨(0âŠ˜1âŠ£â—¶âŸ¨ğ”½âˆ˜âŠ‘âŠ¢â‹„ğ”½Â´âŠ¢âŸ©âŒˆâ—‹â‰ â†‘Â¨â‹ˆ)â—‹(2|âŒŠâˆ˜Ã·âŸœ2âŸ(â†•1+Â·âŒŠ2â‹†â¼1âŒˆâŠ¢))ğ•©}
}

# start clock then tick at the start of every frame to get accurate clock.delta and clock.time
StartClock â† {ğ•Š@:
  # time is relative to when you started the clock
  startTime â‡ â€¢MonoTime@
  lastTime â† 0
  
  delta â‡ 0
  frame â‡ 0

  Time  â‡ {ğ•Š:startTime-Ëœâ€¢Monotime@}
  Tick â‡ {ğ•Š:
    frame+â†©1
    delta â†© lastTime-ËœstartTime-Ëœâ€¢MonoTime@
    lastTime â†© startTime-Ëœâ€¢MonoTime@
    delta
  }
}

mouse â† {
  GetPos     â‡ rayFFI.GetMousePosition âŸ¨âŸ©âŠ£NeedsWindow
  WheelMoved â‡ rayFFI.GetMouseWheelMoveâŸ¨âŸ©âŠ£NeedsWindow
  IsButtonDown â‡ {
    NeedsWindow@
    "Mouse button doesn't exist. (ğ•©âˆŠâ†•7)"!âˆ¨Â´â¥Šğ•©âˆŠâ†•buttons
    rayFFI.IsMouseButtonDownâš‡0 ğ•©
  }
  buttons â† 7
  button â‡ {
    leftâ€¿rightâ€¿middleâ€¿sideâ€¿extraâ€¿forwardâ€¿back â‡ â†•buttons
  }
  cursor â‡ { # Mouse cursor
    default       â‡ 0   # Default pointer shape                                        
    arrow         â‡ 1   # Arrow shape                                                  
    ibeam         â‡ 2   # Text writing cursor shape                                    
    crosshair     â‡ 3   # Cross shape                                                  
    pointing_hand â‡ 4   # Pointing hand cursor                                         
    resize_ew     â‡ 5   # Horizontal resize/move arrow shape                           
    resize_ns     â‡ 6   # Vertical resize/move arrow shape                             
    resize_nwse   â‡ 7   # Top-left to bottom-right diagonal resize/move arrow shape    
    resize_nesw   â‡ 8   # The top-right to bottom-left diagonal resize/move arrow shape
    resize_all    â‡ 9   # The omnidirectional resize/move cursor shape                 
    not_allowed   â‡ 10  # The operation-not-allowed shape                              
  }
}
key â† {
  IsPressed â‡ {ğ•Š key:
    rayFFI.IsKeyPressed @-ËœâŸ<ğ•©
  }âš‡0âŠ£NeedsWindow
  IsDown â‡ {
    rayffi.IsKeyDown @-ËœâŸ<ğ•©
  }âš‡0âŠ£NeedsWindow

  PressedKey â‡ {ğ•¤                                                 # Get key pressed as keycode
    rayFFI.GetKeyPressedâŸ¨âŸ©
  }âŠ£NeedsWindow
  PressedChar â‡ {ğ•¤
    @+rayffi.GetcharPressedâŸ¨âŸ©
  }âŠ£NeedsWindow

  # Keyboard keys (US keyboard layout)
  # NOTE: Use GetKeyPressed() to allow redefining
  # required keys for alternative layouts

  # vars           Keycodes   Keys
  null          â‡ 0        # NULL, used for no key pressed
  # Alphanumeric keys
  apostrophe    â‡ 39       # '
  comma         â‡ 44       # ,
  minus         â‡ 45       # -
  period        â‡ 46       # .
  slash         â‡ 47       # /
  zero          â‡ 48       # 0
  one           â‡ 49       # 1
  two           â‡ 50       # 2
  three         â‡ 51       # 3
  four          â‡ 52       # 4
  five          â‡ 53       # 5
  six           â‡ 54       # 6
  seven         â‡ 55       # 7
  eight         â‡ 56       # 8
  nine          â‡ 57       # 9
  semicolon     â‡ 59       # ;
  equal         â‡ 61       # =
  a             â‡ 65       # A | a
  b             â‡ 66       # B | b
  c             â‡ 67       # C | c
  d             â‡ 68       # D | d
  e             â‡ 69       # E | e
  f             â‡ 70       # F | f
  g             â‡ 71       # G | g
  h             â‡ 72       # H | h
  i             â‡ 73       # I | i
  j             â‡ 74       # J | j
  k             â‡ 75       # K | k
  l             â‡ 76       # L | l
  m             â‡ 77       # M | m
  n             â‡ 78       # N | n
  o             â‡ 79       # O | o
  p             â‡ 80       # P | p
  q             â‡ 81       # Q | q
  r             â‡ 82       # R | r
  s             â‡ 83       # S | s
  t             â‡ 84       # T | t
  u             â‡ 85       # U | u
  v             â‡ 86       # V | v
  w             â‡ 87       # W | w
  x             â‡ 88       # X | x
  y             â‡ 89       # Y | y
  z             â‡ 90       # Z | z
  left_bracket  â‡ 91       # [
  backslash     â‡ 92       # \
  right_bracket â‡ 93       # ]
  grave         â‡ 96       # `
  # Function keys
  space         â‡ 32       # Space
  escape        â‡ 256      # Esc
  enter         â‡ 257      # Enter
  tab           â‡ 258      # Tab
  backspace     â‡ 259      # Backspace
  insert        â‡ 260      # Ins
  delete        â‡ 261      # Del
  right         â‡ 262      # Cursor right
  left          â‡ 263      # Cursor left
  down          â‡ 264      # Cursor down
  up            â‡ 265      # Cursor up
  page_up       â‡ 266      # Page up
  page_down     â‡ 267      # Page down
  home          â‡ 268      # Home
  end           â‡ 269      # End
  caps_lock     â‡ 280      # Caps lock
  scroll_lock   â‡ 281      # Scroll down
  print_screen  â‡ 283      # Print screen
  pause         â‡ 284      # Pause
  f1            â‡ 290      # F1
  f2            â‡ 291      # F2
  f3            â‡ 292      # F3
  f4            â‡ 293      # F4
  f5            â‡ 294      # F5
  f6            â‡ 295      # F6
  f7            â‡ 296      # F7
  f8            â‡ 297      # F8
  f9            â‡ 298      # F9
  f10           â‡ 299      # F10
  f11           â‡ 300      # F11
  f12           â‡ 301      # F12
  left_shift    â‡ 340      # Shift left
  left_control  â‡ 341      # Control left
  left_alt      â‡ 342      # Alt left
  left_super    â‡ 343      # Super left
  right_shift   â‡ 344      # Shift right
  right_control â‡ 345      # Control right
  right_alt     â‡ 346      # Alt right
  right_super   â‡ 347      # Super right
  kb_menu       â‡ 348      # KB menu

  keypad â‡ {
    num_lock    â‡ 282      # Num lock
    zero        â‡ 320      # Keypad 0
    one         â‡ 321      # Keypad 1
    two         â‡ 322      # Keypad 2
    three       â‡ 323      # Keypad 3
    four        â‡ 324      # Keypad 4
    five        â‡ 325      # Keypad 5
    six         â‡ 326      # Keypad 6
    seven       â‡ 327      # Keypad 7
    eight       â‡ 328      # Keypad 8
    nine        â‡ 329      # Keypad 9
    decimal     â‡ 330      # Keypad .
    divide      â‡ 331      # Keypad /
    multiply    â‡ 332      # Keypad *
    subtract    â‡ 333      # Keypad -
    add         â‡ 334      # Keypad +
    enter       â‡ 335      # Keypad Enter
    equal       â‡ 336      # Keypad =
  }
  android â‡ {
    back        â‡ 4        # back button
    menu        â‡ 82       # menu button
    volume_up   â‡ 24       # volume up button
    volume_down â‡ 25       # volume down button
  }
}