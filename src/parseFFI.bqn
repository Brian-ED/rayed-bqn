## Metaprogram rayffi.bqn automatically.

# imports
âŸ¨raylibLibPath
 raylibHeaderPathâŸ© â† conf â† â€¢Import "loadConfig.bqn"
json â† â€¢Import "imports/bqn-libs/json.bqn"
âŸ¨ToFFIâ‹„ParseHeaderâ‹„SetPathâŸ© â† â€¢Import "imports/c-header-to-bqn-ffi/parse.bqn"

HasLibError    â† â€¢file.Existsâˆ˜(".."âŠ¸â€¢file.At)!Ëœ"Library file expected at "âŠ¸âˆ¾âˆ¾" according to config.bqn"Ë™
HasHeaderError â† (â€¢file.Existsâˆ˜(".."âŠ¸â€¢file.At)âˆ§".h"âŠ¸(âŠ£â‰¡-âˆ˜â‰ âŠ¸â†‘))!Ëœ"Header file expected at "âŠ¸âˆ¾âˆ¾" according to config.bqn"Ë™
HasPathsError â† {libPathâ€¿headerPath:
  HasLibError libPath
  HasHeaderError headerPath
}

nl â† @+10

# Doesn't implement nested #if
âŸ¨
  CPreProcessorLean
  CPreProcessorStrict
âŸ© â† {gâ†ğ•©â‹„âŸ¨1 _Gâ‹„0 _GâŸ©}{{[boolsâ‹„defines] DoNotErrorOnMissingDefines _ğ•£ charsOfHeader:
  split â† nl ((âŠ¢-Ëœ+`Ã—Â¬)âˆ˜=âŠ”âŠ¢) ğ•©
  [ifâ‹„endif] â† "#if "â€¿"#endif"(âŠ£â‰¡â‰ âŠ¸â†‘)âŒœâˆ¨`âˆ˜â‰ âŸœ' 'âŠ¸/Â¨split
  1â†“âˆ¾nlâˆ¾Â¨ ((âˆ¨`âˆ§âˆ¨âŸœÂ«)âŸ¨âŸ©âŠ¸â‰¢Â¨)âŠ¸/ endifÂ¬âŠ¸/ğ•—{
    parts â† ğ•© âŠ”Ëœ +` "#elif "âŠ¸(âŠ£â‰¡â‰ âŠ¸â†‘)Â¨ âˆ¨`âˆ˜â‰ âŸœ' 'âŠ¸/Â¨ ğ•©
    ifs â† âˆ¨`âŒ¾âŒ½âˆ˜â‰ âŸœ' 'âŠ¸/Â¨((âŠâŸœ1+Â·Â¬âˆ¨Â´)"//"âŠ¸â·)âŠ¸â†‘Â¨ âˆ¨`âˆ˜Â»âˆ˜=âŸœ' 'âŠ¸/Â¨ âˆ¨`âˆ˜â‰ âŸœ' 'âŠ¸/Â¨âŠ‘Â¨parts
    oob â† definesâŠifs
    ("<#if> condition not defined in ğ•¨ "âˆ¾â€¢Repr ifs)!ğ•—âˆ¨(â‰ defines)â‰¢âŒˆÂ´oob
    definedDefinesâ†(oobâŠâˆ¾âŸœ0âŸğ•— bools)/1â†“Â¨parts
    (âŠ¢âˆ¾âŸ¨âŸ¨âŸ©âŸ©â¥ŠËœ-Ëœâ—‹â‰ âŸœğ•©)Ã—âˆ˜â‰ â—¶âŸ¨âŸ©â€¿âŠ‘definedDefines
  }Â¨âŒ¾(((+`âˆ˜<âŸœÂ»âŠ¸Ã—-Â¬) (1âŒŠ0âŒˆ+)`if-endif)âŠ¸âŠ”)split
}}

ParseRayFFI â† {ğ•ŠlibPathâ€¿headerPath:
  HasPathsError ğ•©
  "../ffi/rayffi.bqn" â€¢FChars libPath SetPath ToFFI "RLAPI" ParseHeader â€¢FChars headerPath
  â€¢Out "ffi/rayffi.bqn successfully generated"
}

ParseRLGL â† {ğ•ŠlibPathâ€¿headerPath:
  HasPathsError ğ•©

  defines â† â‰[
    0â€¿"defined(_WIN32) && defined(BUILD_LIBTYPE_SHARED)"
    0â€¿"defined(BUILD_LIBTYPE_SHARED)"
    0â€¿"!defined(GRAPHICS_API_OPENGL_11) && \"
    0â€¿"defined(GRAPHICS_API_OPENGL_11)"
    0â€¿"defined(GRAPHICS_API_OPENGL_21)"
    0â€¿"defined(GRAPHICS_API_OPENGL_43)"
    0â€¿"defined(GRAPHICS_API_OPENGL_ES3)"
    0â€¿"!defined(__cplusplus) && !defined(bool) && !defined(RL_BOOL_TYPE)"
    0â€¿"defined(GRAPHICS_API_OPENGL_ES2)"
    0â€¿"defined(__cplusplus)"
    0â€¿"defined(GRAPHICS_API_OPENGL_33)"
    0â€¿"defined(_WIN32) && defined(BUILD_LIBTYPE_SHARED)"
    0â€¿"defined(BUILD_LIBTYPE_SHARED)"
    0â€¿"defined(_WIN32) && defined(USE_LIBTYPE_SHARED)"
    0â€¿"(defined(__STDC__) && __STDC_VERSION__ >= 199901L) || (defined(_MSC_VER) && _MSC_VER >= 1800)"
    1â€¿"!defined(RL_MATRIX_TYPE)"
    1â€¿"defined(GRAPHICS_API_OPENGL_11) || defined(GRAPHICS_API_OPENGL_33)"
  ]

  nameMap â† [
    âŸ¨"RLGL_VERSION"âŸ©
    âŸ¨"RLGL_VERSION_STRING"âŸ©
  ]

  headerWMacros â† (âŠâŸœ1"RLGL IMPLEMENTATION"âŠ¸â·)âŠ¸â†‘ â€¢FChars "rlgl.h"âˆ¾Ëœâ€¢file.NameâŠ¸(âˆ¾Ëœâ¼) headerPath
  header â† defines CPreProcessorLean headerWMacros
  "../ffi/rlgl.bqn" â€¢FChars libPath SetPath nameMap ToFFI "RLAPI" ParseHeader header
  â€¢Out "ffi/rlgl.bqn successfully generated"
}

ParseRayGUI â† {ğ•ŠlibPathâ€¿headerPath:
  HasPathsError ğ•©
  headerAndCode â† â€¢FChars headerPath
  header â† Â¯91â†“(1âŠËœ"RAYGUI IMPLEMENTATION"âŠ¸â·)âŠ¸â†‘headerAndCode
  "../ffi/raygui.bqn" â€¢FChars libPath SetPath ToFFI "RAYGUIAPI" ParseHeader header
  â€¢Out "ffi/raygui.bqn successfully generated"
}

ParseRayFFI raylibLibPathâ€¿raylibHeaderPath
ParseRLGL raylibLibPathâ‹ˆ"rlgl.h" â€¢file.AtËœ â€¢file.Parent raylibHeaderPath
conf ParseRayGUIâˆ˜(â€¢ns.GetÂ¨)âŸ(âˆ§Â´â€¢ns.HasÂ¨) "rayguilibpath"â€¿"rayguiheaderpath"