#------------------------------------------------------------------------------------
# BQN low-level function utils
#------------------------------------------------------------------------------------

# BQN Pointer functions
# neccesary for low level programming in bqn
MovePtr  â‡ (256â‹†â†•8){-âŸœ(256Ã—â‰¥âŸœ128)256|âŒŠğ•—Ã·Ëœğ•¨+Â´ğ•—Ã—256|ğ•©}       #      bytes ğ•Š pointer # Move pointer by an amount of bytes
read     â‡ @â€¢FFI ""   â€¿"bqn_readI8Arr"  â€¿"ğ•¨>a"    â€¿">*:i8" #       data ğ•Š pointer # write data to pointer
readi8   â‡ read
readI16  â‡ @â€¢FFI ""   â€¿"bqn_readI16Arr" â€¿"ğ•¨>a"    â€¿">*:i8" #       data ğ•Š pointer # write data to pointer
readI32  â‡ @â€¢FFI ""   â€¿"bqn_readI32Arr" â€¿"ğ•¨>a"    â€¿">*:i8" #       data ğ•Š pointer # write data to pointer
make     â‡ @â€¢FFI "a"  â€¿"bqn_makeI8Vec"  â€¿"ğ•¨>u64"  â€¿">*:i8" # bytesCount ğ•Š pointer # turn data at pointer into a number array
makeI8   â‡ make
makeI16  â‡ @â€¢FFI "a"  â€¿"bqn_makeI16Vec" â€¿"ğ•¨>u64"  â€¿">*:i8" # bytesCount ğ•Š pointer # turn data at pointer into a number array
makeI32  â‡ @â€¢FFI "a"  â€¿"bqn_makeI32Vec" â€¿"ğ•¨>u64"  â€¿">*:i8" #   NumCount ğ•Š pointer # turn data at pointer into a number array
makeUTF8 â‡ @â€¢FFI "a"  â€¿"bqn_makeUTF8Str"â€¿"ğ•¨>u64"  â€¿">*:i8" #     length ğ•Š pointer # turn string at pointer into a bqn string
strLen   â‡ @â€¢FFI "i32"â€¿"strlen"         â€¿">*:i8"           #            ğ•Š pointer # length of unicode C-string

# NumCount ğ•Š pointer # turn data at pointer into a number array
MakeF32 â‡ (@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&f32"â€¿"*i8"â€¿"u64"){
  bytesâ†âˆ˜â€¿4â¥Šğ•© MakeËœ ğ•¨Ã—4
  1âŠ‘âˆ˜âŠ‘Ë˜ğ”½âˆ˜{âŸ¨0âŸ©â€¿ğ•©â€¿4}Ë˜bytes
}

# NumCount ğ•Š pointer # turn data at pointer into a number array
U32ToI8 â‡ âŸ¨@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&i32"â€¿"*u32"â€¿"u64",@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&u32"â€¿"*i32"â€¿"u64"âŸ©{
  ğ”½_ğ•£ğ•©:Fâ€¿Â·â†ğ•—â‹„âŸ¨32â€¿'i'â‹„8â€¿'i'âŸ©â€¢bit._cast 1âŠ‘FâŸ¨0âŸ©â€¿âŸ¨ğ•©âŸ©â€¿4
;
  ğ”½_ğ•£â¼ğ•©:Â·â€¿Fâ†ğ•—â‹„âŠ‘1âŠ‘F{âŸ¨0âŸ©â€¿ğ•©â€¿4} âŸ¨8â€¿'i'â‹„32â€¿'i'âŸ©â€¢bit._cast ğ•©
}