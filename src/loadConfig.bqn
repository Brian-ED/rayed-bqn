intro ← 1↓"
⇐ # This config file is evaluated as a bqn namespace.
# It was autogenerated but you may edit the config however you'd like.
# Any missing variables will be autogenerated and put at the end 
# without editing anything.
# If a setting couldn't be automatically generated then it errors.
# You may use relative paths if you would like, they will be relative to this file.
# If you give a path that wasn't found by rayed-bqn, it errors.
# You may remove this comment.
"
nl ← @+10

confPath ← "../config.bqn"
•FChars⟜intro⍟(¬•file.Exists) confPath
conf ← ⟨⟩ •Import confPath

missing ← ⟨
  "raylibheaderpath"
  "rayliblibpath"
⟩ (¬∘∊/⊣) •ns.Keys conf

os ← •platform.os
{
  e←"Unknown OS, unable to automatically generate config."
  e!∨´os⊸≡¨"linux"‿"darwin"‿"windows"
}

err ← "Incomplete autogeneration of config.bqn: "
Exists ← •file.Exists (•file.Parent confPath)⊸•file.At

newExports ← {
  𝕊"rayliblibpath": {
    os≡"windows"?
      p←".\raylib\lib\raylib.dll"
      (•file.Exists ".." •file.At p)!˜err∾"Couldn't find raylib.dll file at path: "∾p
      𝕩∾" ⇐ "∾•Repr p
  ;
    os≡"darwin"?
      default ← "/usr/local"
      # Using •BQN because CBQN on windows doesn't have the •SH system function
      exitcode‿stdout‿stderr ← ⟨•path⟩ •BQN "•SH ""brew""‿""--prefix""‿""raylib"""
      p ← ∾⟜"/lib/libraylib.dylib"¨"../raylib"⋈(nl⊸≠⊸/stdOut)⍟(exitcode≡0)default
      (∨´m←•file.Exists¨ ".."⊸•file.At¨ p)!˜err∾"Couldn't find libraylib.dylib file at paths:"∾∾nl∾¨p
      𝕩∾" ⇐ •file.At "∾•Repr ⊑m/p
  ;
    os≡"linux"?
      p←"/usr/local/lib/libraylib.so"
      (Exists p)!˜err∾"Couldn't find libraylib.so file at path: "∾p
      𝕩∾" ⇐ "∾•Repr p
  }𝕩
; 𝕊"raylibheaderpath": {
    os≡"windows"?
      p←".\raylib\include\raylib.h"
      (•file.Exists ".." •file.At p)!˜err∾"Couldn't find raylib.h file at path: "∾p
      𝕩∾" ⇐ "∾•Repr p
  ;
    os≡"darwin"?
      default ← "/usr/local"
      # Using •BQN because CBQN on windows doesn't have the •SH system function
      exitcode‿stdout‿stderr ← ⟨•path⟩ •BQN "•SH ""brew""‿""--prefix""‿""raylib"""
      p ← ∾⟜"/include/raylib.h"¨"../raylib"⋈(nl⊸≠⊸/stdOut)⍟(exitcode≡0)default
      (∨´m←Exists¨p)!˜err∾"Couldn't find file raylib.h at paths:"∾∾nl∾¨p
      𝕩∾" ⇐ •file.At "∾•Repr ⊑m/p
  ;
    os≡"linux"?
      p←"/usr/local/include/raylib.h"
      (Exists p)!˜err∾"Couldn't find raylib.h file at path: "∾p
      𝕩∾" ⇐ "∾•Repr p
  }𝕩
;
  !"Attempted to implement non-existant config: "∾𝕩
}¨missing

confPath •FLines newExports∾˜•FLines confPath

•Import confPath