intro ← 1↓"
⇐ # This config file is evaluated as a bqn namespace.
# It was autogenerated but you may edit the config however you'd like.
# Any missing variables will be autogenerated and put at the end 
# without editing anything.
# If a setting couldn't be automatically generated then it errors.
# You may use relative paths if you would like, they will be relative to this file.
# If you give a path that wasn't found by rayed-bqn, it errors.
# You may remove this comment.
"
nl ← @+10

confPath ← "../config.bqn"
•FChars⟜intro⍟(¬•file.Exists) confPath
confNow ← ⟨⟩ •Import confPath

missing ← "raylibpath"‿"bqnlibspath" (¬∘∊/⊣) •ns.Keys confNow

newLines ← •platform.os{𝔽_𝕣:
  𝕗≡"windows"? {
    𝕩≡"raylibpath"?
      p←"../raylib/lib/raylib.dll"
      (•file.Exists p)!˜"Incomplete autogeneration of config.bqn, couldn't find file at path: "∾nl∾p
      𝕩∾" ⇐ "∾•Repr p
  ;
    𝕩≡"bqnlibspath"?
      p←"src/imports/bqn-libs"
      (•file.Exists •file.At p)!˜"Incomplete autogeneration of config.bqn, couldn't find file at path: "∾nl∾p
      𝕩∾" ⇐ •file.At "∾•Repr p
  ;
    !"attempted to implement non-existant config: "∾𝕩
  }
;
  𝕗≡"darwin"? { # macOS, assumes you're using homebrew
    𝕩≡"raylibpath"?
      default ← "/usr/local"
      exitcode‿stdout‿stderr ← ⟨•path⟩ •BQN "•SH ""brew""‿""--prefix""‿""raylib"""
      p ← ∾⟜"/lib/libraylib.dylib"¨"../raylib"⋈(nl⊸≠⊸/stdOut)⍟(exitcode≡0)default
      (∨´m←•file.Exists¨ "../"⊸•file.At¨ p)!˜"Incomplete autogeneration of config.bqn, tried searching for the path to libraylib.dylib at:"∾∾nl∾¨p
      𝕩∾" ⇐ •file.At "∾•Repr ⊑m/p
  ;
    𝕩≡"bqnlibspath"?
      p←"src/imports/bqn-libs"
      (•file.Exists "../"•file.At p)!˜"Incomplete autogeneration of config.bqn, couldn't find file at path: "∾nl∾p
      𝕩∾" ⇐ •file.At "∾•Repr p
  ;
    !"attempted to implement non-existant config: "∾𝕩
  }
;
  𝕗≡"linux"? {
    𝕩≡"raylibpath"?
      p←"/usr/local/lib/libraylib.so"
      (•file.Exists "../"•file.At p)!˜"Incomplete autogeneration of config.bqn, couldn't find file at path: "∾nl∾p
      𝕩∾" ⇐ "∾•Repr p
  ;
    𝕩≡"bqnlibspath"?
      p←"src/imports/bqn-libs"
      (•file.Exists "../"•file.At p)!˜"Incomplete autogeneration of config.bqn, couldn't find file at path: "∾nl∾p
      𝕩∾" ⇐ •file.At "∾•Repr p
  ;
    !"attempted to implement non-existant config: "∾𝕩
  }
;
  !"Unknown OS, unable to automatically generate config."
}¨missing

confPath •FLines newLines∾˜•FLines confPath

•Import "../config.bqn"