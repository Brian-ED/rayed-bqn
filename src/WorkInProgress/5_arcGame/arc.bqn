âŸ¨câ‡color,window,draw,kâ‡keyâŸ©â†râ†â€¢Import "../../../rayed.bqn"
drawBoardâ†â€¢Import"drawBoard.bqn"
âŸ¨_TemplateâŸ©â†â€¢Import "../../../imports/bqn-libs/strings.bqn"
Templateâ†©"@"_Template



lf â† @+10

# level example
##############
#            #
#   ######o  #
#            #
#            #
#  >   /     #
#  #   @     #
##############


âŸ¨empty â‹„playerâ‹„goalOffâ‹„wall  â‹„lMirror
rMirrorâ‹„lLaserâ‹„rLaserâ‹„uLaser â‹„dLaser
âŸ©â‡â†•â‰ charsâ†" @o#\/<>^v"                      # the characters that are used in the level representation

goalOnâ€¿beamUâ†2â†•âŠ¸+â‰ chars

levelsâ†charsâŠ¸âŠâˆ˜>Â¨((+`Ã—Â¬)âŠ¸-0=â‰ Â¨)âŠ¸âŠ”â€¢FLines "levels.txt"

Scene â† {startğ•ŠCloseâ€¿Scene:
  Câ†Scene draw._withCanvas_ c.black
  Câ€¢_While_(window.ShouldClose<Close)ğ•©
}

DT â† {!ğ•©}

StartScreen â† SceneâŸœâŸ¨@â‰¡k.PressedChar
{ğ•©âŠ£30â€¿30 DT"
  Power the machines by moving the mirrors
  Controls: wasd to move, u to undo, r to reset level, q to quit
"}âŸ©
  
MiddleScreen â† SceneâŸœâŸ¨@â‰¡k.PressedChar
{ğ•©âŠ£300â€¿300 DT"
  Good job! Took only "âˆ¾â€¢Reprâˆ˜ğ•©âŠ¸âˆ¾" move"âˆ¾("s"/Ëœ1â‰ ğ•©)âˆ¾".
  Press any key to continue to the next level!
"}âŸ©

EndScreen â† SceneâŸœâŸ¨@â‰¡k.PressedChar
{ğ•©âŠ£300â€¿300 DT"
  Congratulations!!
  You're done with the game, thanks for playing! :)
  Press any key to restart
"}âŸ©

OnStart â† {ğ•¤

  # Definitions
  
  fontâ†r.font.LoadBQN 100
  DT â†© âŸ¨c.whiteâ‹„fontâ‹„30âŸ© draw.TextâŸœâŒ½Â»âŠ¸âˆ¨âˆ˜â‰ âŸœ' 'âŠ¸/âŠ¸â‹ˆËœ
  
  # Running

  StartScreen@

  0â€¿âŸ¨âŸ© Scene 1â€¿{ğ•Šlevelâ€¿moves:
    keyâ†k.PressedChar@
    DrawBoard levelâŠ‘levels
    ğ•©âŠ£0â€¿0 DT "Level "âˆ¾â€¢Repr 1+level
  }
  â€¢internal.Refc font
  r.font.Unload font
}
# On end, show "Well played, you win!"
OnStart window._openAs "Arc"
