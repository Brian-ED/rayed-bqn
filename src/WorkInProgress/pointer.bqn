âŸ¨MovePtrâ‹„Allocâ‡MemAllocâ‹„Modifyâ‡Readâ‹„Makeâ‹„MakeUTF8â‹„StrLenâ‹„MemFreeâŸ© â† rayffi â† â€¢Import "../../rayffi.bqn"
### make sure all inputs are i8
### and make sure to add error message for rank and depth requirement
_asPtr â† {
  (sizeâ¥Š0) Modify ptr â† Alloc sizeâ†â‰ ğ•©

  Set â† {ğ•¨ğ•Šelements:
    index â† ğ•¨âŠ£0
    "Elements has to be a list"!(â‰¡âˆ§=)ğ•©
    "Elements have to be ints"!âŒˆâŠ¸â‰¡ğ•©
    "Writing out of bounds"!sizeâ‰¥index+â‰ ğ•©
    ğ•© Modify index MovePtr ptr
  }
  Show â† {ğ•¤
    size Make ptr
  }

  râ†{
    refâ‡ptr
    Setâ‡Set
    sizeâ‡size
    Showâ‡Show
  }
  ğ”½ r
  Free â† {ğ•¤
    MemFree ptr
    ptrâ†©@ â‹„ sizeâ†©@
    Showâ†©"Can't show freed memory"âŠ¸!
    Setâ†©"Can't set freed memory"âŠ¸!
    Freeâ†©"Already Freed"âŠ¸!
    @
  }
}

memCopyI8ToF32 â† @â€¢FFI"*:i8"â€¿"memcpy"â€¿"&f32"â€¿"*i8"â€¿"u64"
memCopyF32ToI8 â† @â€¢FFI"*:i8"â€¿"memcpy"â€¿"&i8"â€¿"*f32"â€¿"u64"

#xâ† â€¢Show "f32"â€¿"f64"Construct 0â€¿0â€¿Â¯128â€¿63â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0â€¿64â€¿0â€¿0â€¿64â€¿64â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0â€¿16â€¿64â€¿0â€¿0â€¿Â¯128â€¿64â€¿0â€¿0â€¿0â€¿0â€¿0â€¿0â€¿24â€¿64
#â€¢Show "f32"â€¿"f64" Constructâ¼ x

#â€¢Show âŸ¨64â€¿'f'â‹„1â€¿'u'âŸ©â€¢bit._cast âŸ¨1âŸ©
#â€¢Show â€¢ReprâŸ¨64â€¿'f'â‹„32â€¿'i'âŸ©â€¢bit._castâŸ¨2âŸ©
#â€¢Show â€¢ReprâŸ¨64â€¿'f'â‹„32â€¿'i'âŸ©â€¢bit._castâŸ¨6âŸ©

# â€¢Show âŸ¨1â€¿'u'â‹„32â€¿'i'âŸ©â€¢bit._cast âŒ½"00111111100000000000000000000000"-'0'

#len â† 3
#ptr â† rayffi.MemAlloc lenÃ—4+8
#
#âŸ¨
#  0,0,Â¯128,63 â‹„ 0,0,0,0,0,0, 0,64 
#  0,0,  64,64 â‹„ 0,0,0,0,0,0,16,64
#  0,0,Â¯128,64 â‹„ 0,0,0,0,0,0,24,64
#âŸ© rayffi.Read ptr
#MemFree ptr

ScalerTypeSize â† {
  '*'â‰¡âŠ‘ğ•©?64
;
  "["â‰¡âŠ‘ğ•©?
    (ğ•Šğ•©â†“Ëœ2+b)Ã—â€¢ParseFloat ğ•©/Ëœbâ†âˆ§`(1â†“ğ•©)âˆŠ'0'+â†•10
;
  â€¢ParseFloat ğ•©/Ëœâˆ§`âŒ¾âŒ½ğ•©âˆŠ'0'+â†•10
}âˆ§`âˆ˜â‰ âŸœ':'âŠ¸/

StructSize â† {
  flat â† {1=â‰¡ğ•©?ScalerTypeSizeğ•©;ğ•ŠÂ¨âŸ(1<â‰¡)ğ•©}{Fğ•©:{FÂ¨âŒ¾((2â‰¤â‰¡Â¨ğ•©)âŠ¸/)ğ•©}"*:i8"Â¨âŒ¾(('*'â‰¡Â¨âŠ‘Â¨ğ•©)âŠ¸/)ğ•©}ğ•©
}

Cast â† {
  âŸ¨fromâ‹„32â€¿'f'âŸ©ğ•Šğ•©:
    bytes â† âˆ˜â€¿4â¥Šfromâ€¿8â€¢bit._cast ğ•©
    {âŠ‘1âŠ‘MemCopyI8ToF32âŸ¨0âŸ©â€¿ğ•©â€¿4}Ë˜bytes
;
  âŸ¨fromâ‹„8â€¿'u'âŸ©ğ•Šğ•©:
    256|fromâ€¿8â€¢bit._cast ğ•©
;
  âŸ¨32â€¿'f'â‹„toâŸ©ğ•Šğ•©:
    8â€¿to â€¢bit._cast 1âŠ‘MemCopyF32ToI8âŸ¨0â¥ŠËœ4Ã—â‰ ğ•©â‹„ğ•©â‹„4âŸ©
;
  (ğ•¨âŠ¸{"type "âˆ¾(â€¢Repr ğ•©Â¬âŠ¸/ğ•¨)âˆ¾" not supported"}!âˆ§Â´)ğ•¨âˆŠâŸ¨1â€¿'u', 8â€¿'i', 16â€¿'i', 32â€¿'i', 64â€¿'f', 8â€¿'c', 16â€¿'c', 32â€¿'c', 8, 16, 32âŸ©
  ğ•¨â€¢bit._castğ•©
}

Construct â† {
  ğ•Šâ¼:
    widths â† StructSize ğ•¨
    types â† âŠ‘Â¨ğ•¨
    âˆ¾â¥Š(widths(8â€¿'i'â‹ˆËœâˆ¾)Â¨types)(CastÂ¨)â‰1â‹ˆÂ¨ğ•©
;
  widths â† StructSize ğ•¨
  types â† Â¯1âŠ‘âš‡1{-+Â´âˆ§`âŒ¾âŒ½ğ•©âˆŠ'0'+â†•10}âŠ¸â†“âš‡1{Fğ•©:{FÂ¨âŒ¾((2â‰¤â‰¡Â¨ğ•©)âŠ¸/)ğ•©}"*:i8"Â¨âŒ¾(('*'â‰¡Â¨âŠ‘Â¨ğ•©)âŠ¸/)ğ•©}ğ•¨
  (widths(8â‹ˆâˆ¾)Â¨types)âŠ¸(â‹ˆâ¼âˆ˜CastÂ¨)Ë˜((âŠ¢/â†•âˆ˜â‰ )widthsÃ·8)âŠ¸âŠ”Ë˜âŸ¨âˆ˜â‹„8Ã·Ëœ+Â´widthsâŸ©â¥Šğ•©
}
CollapsePtrs â† {ğ•¤{ğ•Â¨âŒ¾((2â‰¤â‰¡Â¨ğ•©)âŠ¸/)ğ•©}"*:i8"Â¨âŒ¾(('*'â‰¡Â¨âŠ‘Â¨ğ•©)âŠ¸/)ğ•©}

rayffi.SetTraceLogLevel rayffi.traceLogLevel.warning # makes logs not output INFO: logs to stdOut

outâ€¿âŸ¨lenâŸ©â†rayffi.LoadModelAnimationsRef "/mnt/0AD47A53D47A414D/Users/brian/Persinal/Scripts/C/raylib/examples/models/resources/models/m3d/cesium_man.m3d"â€¿âŸ¨0âŸ©
â€¢Show out
data â† out rayffi.MakeËœlenÃ—+Â´{(âˆ¾ğ•ŠÂ¨)âŸ(1<â‰¡)â¥Šğ•©} StructSize rayffi.modelAnimation

â€¢Show a_intâ€¿b_intâ†8â€¿32â€¢bit._cast 8â†‘data
â€¢Show ptr1 â† 8â†‘8â†“data
â€¢Show ptr2 â† 8â†‘16â†“data
â€¢Show u8_32 â† 256|32â†‘24â†“data
â€¢Show  32â†“24â†“data

â€¢Show "*{i32,i32,*:i8,*:i8,[32]u8}"
rayffi.UnloadModelAnimation a_intâ€¿b_intâ€¿ptr1â€¿ptr2â€¿u8_32
â€¢Show 3 rayffi.Make ptr1
#â€¢Show CollapsePtrs rayffi.modelAnimation
#â€¢Show rayffi.modelAnimation Construct data
