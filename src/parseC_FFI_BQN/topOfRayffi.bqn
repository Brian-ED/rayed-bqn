# THIS FILE HAS BEEN AUTOGENERATED

on â† 0
NestedStructToStr â‡ {
  1â‰¥â‰¡ğ•©?ğ•©;
  IsPtr â† ("ustr"â‰¡Â¯4âŠ¸â†‘)âˆ¨('*'â‰¡âŠ‘)âˆ¨"str"â‰¡Â¯3âŠ¸â†‘
  (mÂ¬âŠ¸/ğ•©)âˆ¾'{'âˆ¾'}'Â«âˆ¾','âˆ¾Â¨ğ•ŠÂ¨ptrâŸIsPtrâŸ(âŸ¨âŸ©â‰¢â‰¢)Â¨ğ•©/Ëœmâ†Ã—â‰¡Â¨ğ•©
}

# Makes an importer that improves the ffi function creation syntax
MakeImporter â‡ {ğ•¨ğ•Špath: debugâ†ğ•¨âŠ£0
  {ğ•¨ funcName _ğ•£ inpTypes: outTypeâ†ğ•¨âŠ£âŸ¨âŸ©
    IntoStr â† NestedStructToStr
    aâ†'>'âŠ¸âˆ¾âŒ¾âŠ‘âŸ(1=â‰ ) IntoStrÂ¨ğ•©
    HandleError â† {
      â€¢Out "DEBUG TYPE INFO:"
      â€¢Out â€¢Fmt ğ•©
      â€¢Out "END OF DEBUG TYPE INFO; BEGINING WITH FULL ERROR:"
      â€¢term.Flush@
      ğ•¨â€¢FFIğ•©
    }
    func â† path â€¢FFIâŠHandleError âŸ¨ NestedStructToStr outTypeâ‹„funcNameâŸ©âˆ¾a
    m â† strâŠ¸â‰¡Â¨a
    {ğ•âŠ£â€¢term.Flushâˆ˜â€¢Outâˆ˜funcName}âŸdebug {ğ•âˆ¾âŸœ@}âŸ(aâ‰¡â‹ˆ'>'âˆ¾str) {ğ•âˆ¾âŸœ@Â¨âŒ¾(mâŠ¸/)}âŸ(âˆ¨Â´m) func
  }
}

# predefined C types
c â‡ "i8"
bool â‡ "i8"
iâ€¿fâ€¿uâ€¿i8â€¿Â·â€¿u8 â‡ â¥Š"32"â€¿"8"âˆ¾ËœâŒœ"ifu"
strâ€¿uStr â‡ '*'âŠ¸âˆ¾Â¨"iu"âˆ¾Â¨<"8:c8"
ptr â‡ "*:i8"

#------------------------------------------------------------------------------------
# BQN low-level function utils
#------------------------------------------------------------------------------------

# BQN Pointer functions
# neccesary for low level programming in bqn
MovePtr  â‡ {bâ†256â‹†â†•8 â‹„ -âŸœ(256Ã—â‰¥âŸœ128)256|âŒŠbÃ·Ëœğ•¨+Â´bÃ—256|ğ•©}     #      bytes ğ•Š pointer # Move pointer by an amount of bytes
read     â‡ @â€¢FFI "" â€¿"bqn_readI8Arr"  â€¿"ğ•¨>a"    â€¿('>'âˆ¾ptr)  #       data ğ•Š pointer # write data to pointer
readI16  â‡ @â€¢FFI "" â€¿"bqn_readI16Arr" â€¿"ğ•¨>a"    â€¿('>'âˆ¾ptr)  #       data ğ•Š pointer # write data to pointer
readI32  â‡ @â€¢FFI "" â€¿"bqn_readI32Arr" â€¿"ğ•¨>a"    â€¿('>'âˆ¾ptr)  #       data ğ•Š pointer # write data to pointer
make     â‡ @â€¢FFI "a"â€¿"bqn_makeI8Vec"  â€¿"ğ•¨>u64"  â€¿('>'âˆ¾ptr)  # bytesCount ğ•Š pointer # turn data at pointer into a number array
makeI16  â‡ @â€¢FFI "a"â€¿"bqn_makeI16Vec" â€¿"ğ•¨>u64"  â€¿('>'âˆ¾ptr)  # bytesCount ğ•Š pointer # turn data at pointer into a number array
makeI32  â‡ @â€¢FFI "a"â€¿"bqn_makeI32Vec" â€¿"ğ•¨>u64"  â€¿('>'âˆ¾ptr)  #   NumCount ğ•Š pointer # turn data at pointer into a number array
makeUTF8 â‡ @â€¢FFI "a"â€¿"bqn_makeUTF8Str"â€¿"ğ•¨>u64"  â€¿('>'âˆ¾ptr)  #     length ğ•Š pointer # turn string at pointer into a bqn string
strLen   â‡ @â€¢FFI i  â€¿"strlen"         â€¿('>'âˆ¾ptr)            #            ğ•Š pointer # length of unicode C-string

# NumCount ğ•Š pointer # turn data at pointer into a number array
MakeF32 â‡ (@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&f32"â€¿"*i8"â€¿"u64"){
  bytesâ†âˆ˜â€¿4â¥Šğ•© MakeËœ ğ•¨Ã—4
  1âŠ‘âˆ˜âŠ‘Ë˜ğ”½âˆ˜{âŸ¨0âŸ©â€¿ğ•©â€¿4}Ë˜bytes
}

# NumCount ğ•Š pointer # turn data at pointer into a number array
U32ToI8 â‡ âŸ¨@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&i32"â€¿"*u32"â€¿"u64",@â€¢FFI"*:i8"â€¿"memcpy"â€¿"&u32"â€¿"*i32"â€¿"u64"âŸ©{
  ğ”½_ğ•£ğ•©:Fâ€¿Â·â†ğ•—â‹„âŸ¨32â€¿'i'â‹„8â€¿'i'âŸ©â€¢bit._cast 1âŠ‘FâŸ¨0âŸ©â€¿âŸ¨ğ•©âŸ©â€¿4
;
  ğ”½_ğ•£â¼ğ•©:Â·â€¿Fâ†ğ•—â‹„âŠ‘1âŠ‘F{âŸ¨0âŸ©â€¿ğ•©â€¿4} âŸ¨8â€¿'i'â‹„32â€¿'i'âŸ©â€¢bit._cast ğ•©
}