## Metaprogram rayffi.bqn automatically.

ffiUtilsPathâ†âŠ‘â€¢argsâˆ¾<"../ffiUtils.bqn"

nl â† @+10 # newline
json â† â€¢Import "../imports/bqn-libs/json.bqn"

Box â† {>ğ•©Â»Â¨<(âŒˆÂ´â‰ Â¨ğ•©)â¥Šğ•¨âŠ£' '}
LowerNames â† +âŸœ(32Ã—1="A["âŠ¸â‹)âŒ¾(1â†‘âŠ¢)
_MetaParse â† {âˆ¾Ë˜Â´BoxÂ¨ğ•¨âˆ¾âš‡1ğ•—{ğ•ğ•©}Â¨Â¨<Ë˜â‰ğ•©}
_MetaParseFull â† {âˆ¾Ë˜Â´BoxÂ¨ğ•¨âˆ¾âš‡1ğ•—{ğ•ğ•©}Â¨<Ë˜â‰ğ•©}
âŸ¨raylibPathâŸ© â† â€¢Import"../loadConfig.bqn"

mapArgTypes â† {ğ•Š[bqn,c]:{ğ•©LowerNamesâˆ˜âŠ£âŸ(0âŠ¸â‰¡)Â¨(câŠğ•©)âŠbqnâˆ¾<0}6â†“âŸ("const "â‰¡â†‘)Â¨âŠ¢} abcâ†â‰[  
  # pointers
  "'*'âˆ¾boneInfo"      â€¿"boneInfo *"
  "'*'âˆ¾camera3D"      â€¿"Camera *"
  "'*'âˆ¾color"         â€¿"Color *"
  "'*'âˆ¾glyphInfo"     â€¿"GlyphInfo *"
  "'*'âˆ¾image"         â€¿"Image *"
  "'*'âˆ¾material"      â€¿"Material *"
  "'*'âˆ¾materialMap"   â€¿"materialMap *"
  "'*'âˆ¾matrix"        â€¿"Matrix *"
  "'*'âˆ¾mesh"          â€¿"Mesh *"
  "'*'âˆ¾model"         â€¿"Model *"
  "'*'âˆ¾modelAnimation"â€¿"ModelAnimation *"
  "'*'âˆ¾rectangle"     â€¿"rectangle *"
  "'*'âˆ¾texture"       â€¿"Texture2D *"
  "'*'âˆ¾transform"     â€¿"transform *"
  "'*'âˆ¾v2"            â€¿"Vector2 *"
  "'*'âˆ¾v3"            â€¿"Vector3 *"
  "'*'âˆ¾v4"            â€¿"Vector4 *"
  "'*'âˆ¾wave"          â€¿"Wave *"
  """**""âˆ¾rectangle"  â€¿"Rectangle **"
  """**""âˆ¾transform"  â€¿"transform **"

  # remove since they're not defined
  "ptr"â€¿"AudioCallback"
  "ptr"â€¿"LoadFileDataCallback"
  "ptr"â€¿"LoadFileTextCallback"
  "ptr"â€¿"rAudioBuffer *"
  "ptr"â€¿"rAudioProcessor *"
  "ptr"â€¿"SaveFileDataCallback"
  "ptr"â€¿"SaveFileTextCallback"
  "ptr"â€¿"TraceLogCallback"

  # shorten struct names
  "camera3D"     â€¿"Camera"
  "renderTexture"â€¿"RenderTexture2D"
  "texture"      â€¿"Texture2D"
  "texture"      â€¿"textureCubemap"
  "v2"           â€¿"Vector2"
  "v3"           â€¿"Vector3"
  "v4"           â€¿"Vector4"

  "'*'âˆ¾f"   â€¿"float *"
  "'*'âˆ¾i"   â€¿"int *"
  "'*'âˆ¾str" â€¿"char **"
  "'*'âˆ¾u"   â€¿"unsigned int *"
  """*i16"""â€¿"unsigned short *"
  """f64""" â€¿"double"
  """i64""" â€¿"long"
  "f"       â€¿"float"
  "i"       â€¿"int"
  "ptr"     â€¿"..."
  "ptr"     â€¿"void *"
  "str"     â€¿"char *"
  "u"       â€¿"unsigned int"
  "u8"      â€¿"char"
  "u8"      â€¿"unsigned char"
  "ustr"    â€¿"unsigned char *"
]

mapStructTypes â† {ğ•Š[bqn,c]:{ğ•©âŠ£âŸ(0âŠ¸â‰¡)Â¨((LowerNamesÂ¨c)âŠğ•©)âŠbqnâˆ¾0}{
  b â† (âŠ‘âˆ˜âŠÂ¨âŸœ'['-â‰ Â¨)ğ•©
  "ptrâŠ£"âŠ¸âˆ¾âŸ(('*'â‰¡1âŠ‘2â†‘âŠ¢)âˆ¨("ustr"â‰¡4â†‘âŠ¢)âˆ¨"str"â‰¡3â†‘âŠ¢)Â¨ 3âŠ¸â†“Â¨âŒ¾((0=b)âŠ¸/) ğ”½{'"'âˆ¾Â¨(bâ†‘Â¨ğ•©)âˆ¾Â¨"""âˆ¾"âŠ¸âˆ¾Â¨ğ”½ bâ†“Â¨ğ•©} LowerNamesÂ¨ğ•©
}6â†“âŸ("const "â‰¡â†‘)Â¨âŠ¢}abc

mapStructNames â† {ğ•Š[bqn,c]:{ğ•©LowerNamesâˆ˜âŠ£âŸ(0âŠ¸â‰¡)Â¨(câŠğ•©)âŠbqnâˆ¾<0}6â†“âŸ("const "â‰¡â†‘)Â¨âŠ¢}â‰[  
  "v4"â€¿"Vector4"
  "v3"â€¿"Vector3"
  "v2"â€¿"Vector2"
]

MapFuncReturnType â† " "âŸ("void"âŠ¸â‰¡)Â·{'('âˆ¾ğ•©âˆ¾')'}âŸ(âˆ¨Â´"âˆ¾âŠ£"âŠ¸âˆŠ)MapStructTypesâŒ¾â‹ˆ

definesâ€¿structsâ€¿aliasesâ€¿enumsâ€¿callbacksâ€¿functionsâ†{
  xâ†â‰json.Parse â€¢FChars "./inp-out/raylib.json"
  !(âŠË˜x)â‰¡"defines"â€¿"structs"â€¿"aliases"â€¿"enums"â€¿"callbacks"â€¿"functions"
  1âŠË˜x
}
{ğ•Šğ•©: 
  â¥Šnlâˆ¾Ë˜""â€¿" â‡ "â€¿" # "âŸ¨LowerNames,LowerNames,âŠ¢âŸ©_MetaParse 1â€¿0â€¿2âŠ¸âŠË˜>1âŠÂ¨ğ•©
}aliases

"./inp-out/rayffi.bqn"â€¢FLines (â€¢FLines "topOfRayffi.bqn") âˆ¾(â‹ˆ"r â‡ MakeImporter """âˆ¾raylibPathâˆ¾'"')âˆ¾âˆ¾Â´âŸ¨
  { # defines
    Parse â† {âˆ¾Ë˜Â´BoxÂ¨""â€¿""â€¿" â‡ "â€¿" # "âˆ¾âŸ(âŸ¨âŸ©â‰¢âŠ¢)âš‡1âŸ¨LowerNames,âŸ¨âŸ©Ë™,â€¢Repr,âŠ¢âŸ©{ğ•ğ•©}Â¨Â¨ <Ë˜â‰ğ•©}
    exclTypes  â† "GUARD"â€¿"MACRO"â€¿"UNKNOWN"â€¿"FLOAT_MATH"â€¿"COLOR"
    Filter     â† {ğ•Šnâ€¿tâ€¿vâ€¿d: # nameâ€¿typeâ€¿valâ€¿desc
      Â¬âˆ¨Â´âŸ¨"PI"â‰¡n, âˆ¨Â´tâŠ¸â‰¡Â¨exclTypes, âŸ¨âŸ©â‰¡v âŸ©
    }
    <Ë˜Parse FilterË˜âŠ¸/ 1âŠË˜Ë˜ >â‰Â¨defines
  }
  { # structs
    ParseStruct â† {
      âˆ¾(@+10)âˆ¾Â¨"âŸ©"âˆ¾Ëœ<Ë˜"  "âˆ¾â‰1""â€¿" # "â€¿"  # "âŸ¨âŠ¢, âŠ¢,âŠ¢âŸ©_MetaParse MapStructTypesâŒ¾(âŠË˜) >ğ•©
    }
    Parse â† { # ğ•Š â‰[name,desc,fields]:
      header â† (Â»âŠ¸âˆ¨' 'âŠ¸â‰ )âŠ¸/Â¨<Ë˜""â€¿" â‡ S âŸ¨ # "âŸ¨LowerNames,âŠ¢âŸ©_MetaParse MapStructNamesâŒ¾(âŠË˜) 2â†‘Ë˜ğ•©
      body â† âˆ¨`âŒ¾âŒ½âˆ˜â‰ âŸœ' 'âŠ¸/Â¨<Ë˜âŸ¨""âŸ©âŸ¨ParseStruct 1âŠÂ¨âŠ¢âŸ©_MetaParse Â¯1â†‘Ë˜3â†‘Ë˜ğ•©
      body âˆ¾ËœÂ¨header
    }âŒ½âŒ¾(1â†“âŠ¢)Ë˜âŒ¾â‰
    Parse 1âŠË˜Ë˜>â‰Â¨âŒ½structs
  }
  { # enums
    ParseNamespaceâ†{ğ•Šnameâ€¿descriptionâ€¿values:
      header â† (LowerNames name)âˆ¾" â‡ { # "âˆ¾description
      body   â† ""â€¿" â‡ "â€¿"  # "âŸ¨LowerNames,â€¢Repr,âŠ¢âŸ©_MetaParse >1âŠÂ¨values
      (nlâˆ¾"}")âˆ¾Ëœheaderâˆ¾âˆ¾(nlâˆ¾"  ")âŠ¸âˆ¾Â¨<Ë˜body
    }
    ParseNamespaceÂ¨1âŠÂ¨enums
  }
  { # functions
    FillTitles â† âŠ¢Ë # "name"â€¿"description"â€¿"returnType"â€¿"params"
    <Ë˜âŸ¨"", " â‡ ", "", " _R"," # "âŸ©âŸ¨
      LowerNamesÂ¨
      MapFuncReturnTypeÂ¨
      '"'âˆ¾Â¨âˆ¾âŸœ'"'Â¨
      <Ë˜"âŸ¨"â€¿"âŸ© #"âŸ¨{<Ë˜1â†“Ë˜âˆ¾Ë˜Â´('â‹„'âŠ¸âˆ¾Ë˜)Â¨ BoxÂ¨<Ë˜â‰(<"") Box MapArgTypesÂ¨ğ•©},âˆ¾Â¨' 'âŠ¸âˆ¾Â¨Â¨âŸ©_MetaParseFull Â·(â‰0âŠ¸âŠÂ¨â‰1âŠ¸âŠÂ¨){2â€¿âˆ˜â¥Šâ‰>1âŠÂ¨ğ•©}Â¨
      âŠ¢
    âŸ©_MetaParseFull{# â‰[name, description, returnType, params]:
      0â€¿1â€¿0â€¿2â€¿3âŠ¸âŠË˜0â€¿2â€¿3â€¿1âŠ¸âŠË˜ğ•©
    }> FillTitlesÂ¨functions
  }
âŸ©