âŸ¨
  rlâ‡raylib
  window
  model
  color
âŸ© â† r â† â€¢Import "../../rayed.bqn"


Game â† {ğ•Š:
  r.mouse.cursor.Disable@

  # Define the camera to look into our 3d world
  camera â† âŸ¨
    50â€¿50â€¿50  # Camera position
    0â€¿10â€¿0    # Camera looking at point
    0â€¿1â€¿0     # Camera up vector (rotation towards target)
    45        # Camera field-of-view Y
    r.cameraProjection.perspective # Camera mode type
  âŸ©

  compressedFiles â† "OBJ/Map__5_Normal_Bump.tga"â€¿"OBJ/RubberDuck_LOD0.obj"
  {
    data â† â€¢FBytes ğ•©âˆ¾".comp"
    pâ€¿âŸ¨sâŸ© â† rl.DeCompressDataRefâŸ¨data,â‰ data,â‹ˆ0âŸ©
    d â† (p.Cast "u8").ReadÂ¨â†•s
    ğ•© â€¢FBytes @+d
  }Â¨compressedFiles

  # A model consists of a matrix, meshes, materials, bones
  duck â† r.model.LoadFile â€¢file.At "OBJ/RubberDuck_LOD0.obj"

  â€¢file.RemoveÂ¨compressedFiles

  # run PerFrame while the window shouldn't close
  duck PerFrameâ€¢_While_(Â¬window.ShouldClose) camera

  # Unloading model, freeing it's memory.
  rl.UnloadModel duck
}

PerFrame â† {duckğ•ŠoldCamera:
  # Look for keystrokes from user, move the camera
  camera â† âŠ‘âŠ‘rl.UpdateCameraRef âŸ¨â‹ˆoldCameraâ‹„rl.cameraMode.camera_third_personâŸ©

  # Preparing another buffer to draw the new frame, with white background
  {ğ•Š:
    # Draws FPS at x=40 y=40
    rl.DrawFPS 40â€¿40

    # Draw 3d stuff relative to the camera
    rl.BeginMode3D camera

      # draws grid
      rl.DrawGrid 20â€¿10

      # Draw the duck model at position
      position â† 0â€¿0â€¿0 â‹„ scale â† 1
      rl.DrawModel duckâ€¿positionâ€¿scaleâ€¿color.white

    # Stop drawing 3d
    rl.EndMode3DâŸ¨âŸ©

  } r.draw._withCanvas_ r.color.white@

  camera # return the output state
}

Game window._openAs "Example!"