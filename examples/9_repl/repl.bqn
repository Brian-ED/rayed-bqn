âŸ¨coâ‡color,window,âŸ¨_withCanvas_âŸ©â‡draw,kâ‡keyâŸ©â†râ†â€¢Import "../../raylib.bqn"
âŸ¨lf,SplitâŸ©  â† â€¢Import "../../src/imports/bqn-libs/strings.bqn"
sysVals     â† â€¢Import"sysVals.bqn"
fontSize    â† 50
lineSpacing â† 40
charSize    â† 27â€¿50
IsD â† r.rayffi.IsKeyDown

mkUTF â†@â€¢FFI"a"â€¿"bqn_makeUTF8Str"â€¿"u64"â€¿"*:i8"
strlenâ†@â€¢FFI"u64"â€¿"strlen"â€¿">*:i8" â‹„ 
#MkUTF r.rayffi.GetCodepointCountPâŠ¸â‹ˆ r.rayffi.GetClipboardText@
Game â† {ğ•¤
  window.SetPos 0â€¿540
  fontâ†r.font.LoadBQN fontSize
  DrawText â† {posğ•Šstr:r.rayFFI.DrawTextCodepoints âŸ¨font, str-@, â‰ str, pos, fontSize, 1, co.blueâŸ©}
  rmFnâ†0
  Back â† {ğ•¤
    rmFnâ†©1
  }
  bqn â† â€¢ReBQN{
    sâ†sysvalsâˆ¾âŸ¨"r"â€¿r,"drawtext"â€¿DrawText,"back"â€¿BackâŸ©
    system â‡ sâˆ¾<"listsys"(âŠ£â‹ˆ<âŠ¸âˆ¾)âŠ‘Â¨s
    repl   â‡ "loose"
  }
  BQN "
    âŸ¨mâ‡mouse,âŸ¨whiteâŸ©â‡color,âŸ¨rectangleâŸ©â‡draw,textureâŸ©â†râ†â€¢r
    backâ†â€¢back
  "
  KeyFuncâ†{kyğ•Šsâ€¿fâ€¿p: Nâ†0âŒˆ-âŸœ1 â‹„ Aâ†(â‰ s)âŒŠ+âŸœ1 â‹„ {
  (k.backspaceâ‰¡ky)âˆ§IsD k.left_control?""â€¿fâ€¿0
  ;k.backspaceâ‰¡ky? âŸ¨p(NâŠ¸â†‘âˆ¾â†“)sâ‹„fâ‹„N pâŸ©
  ;(IsD k.leftControl)âˆ§k.enterâ‰¡ky? âŸ¨p(â†‘âˆ¾lfâˆ¾â†“)sâ‹„fâ‹„A pâŸ©
  ;k.enterâ‰¡ky?
    (3â‰¡â€¢Type)â—¶âŸ¨
      {(<âˆ¾fâ‹ˆâ‰ )â€¢ReprâŠ""ğ•©}
      {(<âˆ¾(fâˆ¾ğ•©)â‹ˆâ‰ )"Activating function per frame"}
    âŸ©BQNâŠâ€¢currentError s
  ;k.leftâ‰¡ky?  sâ€¿fâˆ¾N p
  ;k.rightâ‰¡ky? sâ€¿fâˆ¾A p
  ;(k.vâ‰¡ky)âˆ§IsD k.leftControl?
    clipS â† MkUTF StrlenâŠ¸â‹ˆ r.rayffi.GetClipboardText@
    âŸ¨p(â†‘âˆ¾clipSâˆ¾â†“)s,f,p+â‰ clipSâŸ©
  ;sâ€¿fâ€¿p
  }}

  # Perframe
  {ğ•Šsâ€¿fâ€¿p:
    kyâ€¿c â† {1â†“ğ•âŠ¸âˆ¾â€¢_While_(âˆ§Â´0â€¿@â‰ âŠ‘)ğ•@}Â¨k.PressedKeyâ€¿k.PressedChar # Input
    {kyâ€¿cğ•s}Â¨f
    # â€¢ShowâŸ(âŸ¨âŸ©âŠ¸â‰¢)k # debugging
    newSâ†âŠ‘rrâ†{rmFnâ†©0â‹„Â¯1âŠ¸â†“âŒ¾(1âŠ‘âŠ¢)ğ•©}âŸrmFn(+âŸœ(â‰ c)â‹ˆâ†‘âˆ¾câˆ¾â†“)Â´âŒ¾(2â€¿0âŠ¸âŠ)sâ€¿fâ€¿p KeyFuncÂ´ky
    # Rendering
    {
      DrawTextËœÂ´Â¨(âŠ¢â‹ˆÂ¨50âˆ¾Â¨50Ã—â†•âˆ˜â‰ )lf Splitğ•©
      co.white r.draw.Line â‰[0â€¿0,0â€¿50]+50â€¿0+charSizeÃ—(âˆ§`âŒ¾âŒ½âˆ˜Â¬â‹ˆâ—‹(+Â´)âŠ¢)lf=pâ†‘s
    }_withCanvas_ co.black newS 
    
    rr
  }â€¢_While_(Â¬window.ShouldClose) ""â€¿âŸ¨âŸ©â€¿0

  r.rayffi.UnloadFont font
}
0.5 Game window._openAs "BQN Repl"

# white _RectangleËœ100â€¿100Ë™
# Back@
# frameâ†posâ†wheelâ†0
# {ğ•Š:frame(100|+)â†©1}
# {ğ•¤
#   qâ†âˆ¾Ë˜Ë˜âŸœâŒ½1â€¿Â¯1-âŠ¸â‰âŠ¸Ã—|0â€¿100-frame # Morphing
#   sâ†âˆ¾Ë˜Ë˜ËqâŠ¸+Ë˜â·âŒ½Ë˜âŠ¸âˆ¾100Ã—0âˆ¾Ë˜Â¬â†•3    # duping
#   white EO r.mouse.GetPosâŠ¸+s   # moving + drawing
# }