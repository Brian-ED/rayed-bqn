## Conventions:
# One big goal of this lib is to eliminate as many bugs of raylib as possible,
# for example, opening the window twice is impossible because it is not intended in raylib, and causes many bugs.

# x and y as variables (also x1 y1, x2 y2 etc) are always positions

# -------
# Exports
âŸ¨
  draw, texture, monitor, window, mouse
  font, key, clipboard, StartClock
  sound, bqnoise, raymath, image, low
âŸ©â‡

âŸ¨
  traceLogLevel
  gamepadButton, gamepadAxis
  materialMapIndex
  shaderLocationIndex, shaderUniformDataType, shaderAttributeDataType
  pixelFormat
  textureFilter, textureWrap
  cubemapLayout
  fontType
  blendMode
  gesture
  cameramode, cameraProjection
  nPatchLayout
  color
âŸ© â‡ âŸ¨
  bqnFontChars
  windowConfigFlags
âŸ© â† â€¢Import "src/constants.bqn"

global â† â€¢Import "src/global.bqn"
NeedsWindow â† {window.isOpen?ğ•©;!"Expected window to be open"}
global.SetNeedsWindow needsWindow

# Loading dependencies
â€¢Importâˆ˜"src/parseFFI.bqn"âŸÂ¬â€¢file.Exists "config.bqn"
âŸ¨raylibâŸ© â‡ {
  paths â† âŸ¨"ffi/raylib.bqn"âŸ©
  tried â† â€¢ImportâŠ{
    0âŠ£â€¢Out "Error running "âˆ¾ğ•©
  }Â¨paths
  paths{
    â€¢Out "Attempting reparsing for automatic fix."
    â€¢Import "src/parseFFI.bqn"
    â€¢Outâˆ˜"Fix successful"âŠ¸âŠ¢ â€¢ImportÂ¨ğ•¨
  }âŸ(âŸ¨âŸ©âŠ¸â‰¢)âŒ¾((0âŠ¸â‰¡Â¨tried)âŠ¸/)tried
}
raymath â† â€¢Import "src/raymath.bqn"
image   â† â€¢Import "src/image.bqn"
low     â† â€¢Import "src/low.bqn"
bqnoise â† â€¢Import "src/imports/BQNoise/wav.bqn"
bqnoiseOptions â† â€¢Import "src/imports/BQNoise/options.bqn"
# -------

# Utils:
FileAt â† "/cygdrive/c"("C:"âˆ¾â‰ âŠ¸â†“)âŸ(âŠ£â‰¡â‰ âŠ¸â†‘)â€¢file.At                # remade â€¢FileAt to work for cygwin

# Defaults
raylib.SetTraceLogLevel traceLogLevel.warning # makes logs not output INFO: logs to stdOut

# constants
i32_max â† Â¯1+2â‹†31

texture â† {
  âŸ¨ Load â‹„ Unload â‹„ _WithImage â‹„ _withFile â‹„ _WithRayImage âŸ©â‡
  # texture.Load
  Load â† {ğ•ŠfilePath: # Load texture from file into GPU memory (VRAM)
    NeedsWindow@
    {!"Path given wasn't absolute ğ•©â‰¡"âˆ¾â€¢Reprğ•©}âŸ("."âŠ¸â€¢file.AtâŠ¸â‰¢)ğ•©
    {ğ•Š:!"Couldn't find file at "âˆ¾â€¢file.RealPath filePath}âŸÂ¬â€¢file.Exists ğ•©
    raylib.LoadTexture ğ•©
  }
  # texture.Unload
  Unload â† {ğ•Štexture: NeedsWindow@ â‹„ @âŠ£raylib.UnloadTextureğ•©}
  # texture._with
  _withFile â† {ğ”½_ğ•£ filePath : (UnloadâŠ¢ğ”½)Loadğ•©}
  # texture._withRayImage
  _withRayImage â† {
    NeedsWindow@
    (UnloadâŠ¢ğ”½)raylib.LoadTextureFromImage ğ•©
  }
  # texture._withImage
  _withImage â† {
    NeedsWindow@
    (UnloadâŠ¢ğ”½)raylib.LoadTextureFromImage image._AsRayImg ğ•©
  }
}
monitor â† {
  âŸ¨Selected â‹„ Count
   RefreshRate â‹„ Size
   Sizemm â‹„ Name â‹„ GetPosâŸ©â‡
  # monitor.Selected
  Selected â† {ğ•¤
    NeedsWindow@
    raylib.GetCurrentMonitorâŸ¨âŸ©
  }
  # monitor.Count
  Count â† {ğ•¤
    NeedsWindow@
    raylib.GetMonitorCountâŸ¨âŸ©
  }

  notAMonitorErr â† "Invalid monitor ğ•©, can only be @ for currently selected monitor or a monitor number; ( ğ•©âˆŠâ†•monitor.Count@ ) v ( ğ•©â‰¡@ )"
  M â† @âŠ¸â‰¢â—¶Selectedâ€¿{ğ•©âŠ£notAMonitorErr!âŠ‘ğ•©âˆŠâ†•Count@} # No need for NeedsWindow because Selected and Count need it so error still works

  # monitor.RefreshRate
  RefreshRate â† {ğ•Šmonitor:
    raylib.GetMonitorRefreshRate M ğ•©
  }
  # monitor.Size
  Size â† {ğ•Šmonitor:
    (raylib.GetMonitorWidth âˆ¾ raylib.GetMonitorHeight)M ğ•©
  }
  # Get size in milimeters
  # monitor.Sizemm
  Sizemm â† {ğ•Šmonitor:
    (raylib.GetMonitorPhysicalWidth âˆ¾ raylib.GetMonitorPhysicalHeight)M ğ•©
  }
  # monitor.Name
  Name â† {ğ•Šmonitor:
    raylib.GetMonitorName M ğ•©
  }
  # monitor.GetPos
  GetPos â† {ğ•¤
    raylib.GetMonitorPosition M ğ•©
  }
}

# window functionality
window â† {
  âŸ¨
    _openAs â‹„ Open â‹„ Close â‹„ isOpen â‹„ SetIcon â‹„ fps â‹„ GetSize
    ShouldClose â‹„ Needed â‹„ SetPos â‹„ GetPos â‹„ SetSize â‹„ configFlags
    SetTitle

    IsFullscreen        â‹„ SetFullscreen
    IsResizable         â‹„ SetResizable
    IsDecorated         â‹„ SetDecorated
    IsTransparent       â‹„ SetTransparent
    IsMsaa4xhint        â‹„ Setmsaa4xhint
    IsVsyncHint         â‹„ Setvsynchint
    IsHidden            â‹„ SetHidden
    IsRunWhileMinimized â‹„ SetRunWhileMinimized
    IsMinimized         â‹„ SetMinimized
    IsMaximized         â‹„ SetMaximized
    IsFocused           â‹„ SetFocused
    IsTopmost           â‹„ SetTopmost
    IsHighDPI           â‹„ SetHighDPI
    IsMousePassThrough  â‹„ SetMousePassThrough
    IsInterlacedhint    â‹„ SetInterlacedhint

    GetState â‹„ stateNames # get binary list of above settings (including empty ones in the raylib binary format)
  âŸ©â‡
  # window.Needed
  Needed â† NeedsWindow
  isOpen â† 0

  # Get the xâ€¿y position of the window   (relative to current monitor?)
  # window.GetPos
  GetPos â† {raylib.GetWindowPositionâŸ¨âŸ©âŠ£NeedsWindowğ•©}
  
  # Set the xâ€¿y position of the window   (relative to current monitor?)
  # window.SetPos
  SetPos â† {
    NeedsWindow@
    raylib.SetWindowPositionğ•©
  }

  # tempSize is used to store size until window is open
  tempSize â† 0â€¿0

  # Set the width and hight of the window, width and hight being relative to window position
  # window.SetSize
  SetSize â† {ğ•Šsize:
    ((âŒˆâŠ¸â‰¡âˆ¨âŠ¢â‰¡0âŒˆ1âŒŠâŠ¢)ğ•©)!Ëœ"Size can only be between 0 and 1, or a positive whole number"
    ((âŸ¨âŸ©âŠ¸â‰¡âˆ¨âŸ¨2âŸ©âŠ¸â‰¡)â‰¢ğ•©)!Ëœ"Size can be a scaler (âŸ¨âŸ©â‰¢â‰¢ğ•¨) or length two list (âŸ¨2âŸ©â‰¡â‰¢ğ•¨)"
    isOpen?
      s â† (raylib.GetMonitorWidth âˆ¾ raylib.GetMonitorHeight) raylib.GetCurrentMonitorâŸ¨âŸ©
      f â† (1âŠ¸>âˆ§0âŠ¸â‰¤)ğ•©
      # if given size is 0-1, scale the window relative to monitor size
      raylib.SetWindowSize âŒˆ2â¥ŠsÃ—âŸœÂ¬âŒ¾(fâŠ¸/)2â¥Šğ•©
  ;
    tempSizeâ†©ğ•©
  }
  
  # Get the width and hight of the window, width and hight being relative to window position
  # window.GetSize
  GetSize â† {ğ•¤
    isOpen?
      âŸ¨raylib.GetScreenWidthâŸ¨âŸ©
       raylib.GetScreenHeightâŸ¨âŸ©âŸ©
  ;
    tempSize
  }

  # Open the window with default settings
  # window.Open
  Open â‡ {ğ•Š title:
    (Â¬isOpen)!Ëœ"The window cannot be opened twice"
    raylib.InitWindow 0â€¿0â€¿ğ•©
    raylib.SetWindowPositionâŸ("windows"â‰¡â€¢platform.os) 0â€¿42 # 42 here is the window header on windows only

    raylib.SetWindowState 2âŠ¸Ã—âŠ¸+ËœÂ´ GetState@

    !raylib.IsWindowReadyâŸ¨âŸ©
    isOpenâ†©1

    SetSize tempSize

    raylib.SetExitKey 0 # 0 means no key, essentially removing esc key closing programs implicitly
    raylib.SetWindowPositionâŸ("windows"â‰¡â€¢platform.os) 0â€¿42 # 42 here is the window header on windows only
    # Setting fps to the refresh rate of the currently selected monitor
    fps.Set raylib.GetMonitorRefreshRate raylib.GetCurrentMonitorâŸ¨âŸ©
    window
  }
  # window.ShouldClose
  ShouldClose â† {ğ•¤
    NeedsWindow@
    raylib.WindowShouldCloseâŸ¨âŸ©
  }
  # window.Close
  Close â† {
    NeedsWindow@
    raylib.CloseWindowâŸ¨âŸ©
    ğ•©âŠ£isOpenâ†©0
  }
  # window.OpenAs
  _openAs â† {App _ğ•£ title: sizeâ†ğ•¨âŠ£1
    Open ğ•©
    CloseâŠ¸âŠ¢ğ”½@
  }
  # TODO: Needs to test input for image
  # window.SetIcon
  SetIcon â† {ğ•Šimage: NeedsWindow@ â‹„ raylib.SetWindowIconğ•©} image._AsRayImg

  #window.SetTitle
  SetTitle â† {
    NeedsWindow@
    "ğ•© has to be a list of characters"!(=ğ•©)âˆ§âˆ§Â´2=â€¢TypeÂ¨ğ•©
    raylib.SetWindowTitle ğ•©
  }

  fps â† {
    # window.fps.Get
    Get â‡ {ğ•¤
      NeedsWindow@
      raylib.GetFPSâŸ¨âŸ©
    }
    # window.fps.Set
    Set â‡ {
      (ğ•©=0âŒˆâŒˆğ•©)!Ëœ"FPS has to be a positive int"
      ğ•©âŠ£raylib.SetTargetFPSğ•©
    }âŠ£NeedsWindow
  }
  # window.configFlags
  configFlags â† windowConfigFlags

  fullscreen        â† 0 # Set to run program in fullscreen                                              # window.fullscreen
  resizable         â† 1 # Set to allow resizable window                                                 # window.resizable
  decorated         â† 1 # Set to 0 to disable window decoration (frame and buttons)                     # window.decorated
  transparent       â† 0 # Set to allow transparent framebuffer                                          # window.transparent
  msaa4xhint        â† 0 # Set to try enabling MSAA 4X                                                   # window.msaa4xhint
  vsyncHint         â† 0 # Set to try enabling V-Sync on GPU                                             # window.vsyncHint
  hidden            â† 0 # Set to hide window                                                            # window.hidden
  runWhileMinimized â† 0 # Set to allow windows running while minimized                                  # window.runWhileMinimized
  minimized         â† 0 # Set to minimize window (iconify)                                              # window.minimized
  maximized         â† 0 # Set to maximize window (expanded to monitor)                                  # window.maximized
  focused           â† 1 # Set to 0 to non focus window                                                  # window.focused
  topmost           â† 0 # Set to window always on top                                                   # window.topmost
  highDPI           â† 0 # Set to support HighDPI                                                        # window.highDPI
  mousePassThrough  â† 0 # Set to support mouse passthrough, only supported when FLAG_WINDOW_UNDECORATED # window.mousePassThrough
  interlacedhint    â† 0 # Set to try enabling interlaced video format (for V3D)                         # window.interlacedhint

  # array of Clearâ€¿Set that clears(Clear sets var to 0) and sets(Set var to 1) used as â—¶cs
  # window state not available on some platforms so will replace clearâ€¿set with other functions like ToggleFullscreen
  cs â† raylib.ClearWindowStateâ€¿raylib.SetWindowState
  cf â† configFlags

  SetFullscreen        â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ fullscreen        â†© ğ•© âŠ£ raylib.ToggleFullscreenâˆ˜âŸ¨âŸ©âŸâŠ¢isopenâˆ§ğ•©â‰ IsFullscreen@} # window.SetFullscreen
  SetResizable         â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ resizable         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_resizable         } # window.SetResizable
  SetDecorated         â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ decorated         â†© ğ•© âŠ£ Â¬âˆ˜ğ•©â—¶csâŸisOpen cf.window_undecorated       } # window.SetDecorated
  SetTransparent       â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ transparent       â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_transparent       } # window.SetTransparent
  Setmsaa4xhint        â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ msaa4xhint        â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.msaa4xhint               } # window.Setmsaa4xhint
  Setvsynchint         â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ vsyncHint         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.vsync_hint               } # window.Setvsynchint
  SetHidden            â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ hidden            â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_hidden            } # window.SetHidden
  SetRunWhileMinimized â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ runWhileMinimized â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_always_run        } # window.SetRunWhileMinimized
  SetMinimized         â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ minimized         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_minimized         } # window.SetMinimized
  SetMaximized         â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ maximized         â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_maximized         } # window.SetMaximized
  SetFocused           â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ focused           â†© ğ•© âŠ£ Â¬âˆ˜ğ•©â—¶csâŸisOpen cf.window_unfocused         } # window.SetFocused
  SetTopmost           â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ topmost           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_topmost           } # window.SetTopmost
  SetHighDPI           â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ highDPI           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.highDPI                  } # window.SetHighDPI
  SetMousePassThrough  â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ topmost           â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_mouse_passthrough } # window.SetMousePassThrough
  SetInterlacedhint    â‡ {!âŠ‘ğ•©âˆŠâ†•2 â‹„ interlacedhint    â†© ğ•© âŠ£   ğ•©â—¶csâŸisOpen cf.window_interlacedhint    } # window.SetInterlacedhint

  IWS â† raylib.IsWindowState
  IsFullscreen        â‡ {ğ•Š: isOpen? IWS cf.fullscreen_mode          ; fullscreen        }
  IsResizable         â‡ {ğ•Š: isOpen? IWS cf.window_resizable         ; resizable         }
  IsDecorated         â‡ {ğ•Š: isOpen? IWS cf.window_undecorated       ; decorated         }
  IsTransparent       â‡ {ğ•Š: isOpen? IWS cf.window_transparent       ; transparent       }
  IsMsaa4xhint        â‡ {ğ•Š: isOpen? IWS cf.msaa4xhint               ; msaa4xhint        }
  IsVsyncHint         â‡ {ğ•Š: isOpen? IWS cf.vsync_hint               ; vsyncHint         }
  IsHidden            â‡ {ğ•Š: isOpen? IWS cf.window_hidden            ; hidden            }
  IsRunWhileMinimized â‡ {ğ•Š: isOpen? IWS cf.window_always_run        ; runWhileMinimized }
  IsMinimized         â‡ {ğ•Š: isOpen? IWS cf.window_minimized         ; minimized         }
  IsMaximized         â‡ {ğ•Š: isOpen? IWS cf.window_maximized         ; maximized         }
  IsFocused           â‡ {ğ•Š: isOpen? IWS cf.window_unfocused         ; focused           }
  IsTopmost           â‡ {ğ•Š: isOpen? IWS cf.window_topmost           ; topmost           }
  IsHighDPI           â‡ {ğ•Š: isOpen? IWS cf.highDPI                  ; highDPI           }
  IsMousePassThrough  â‡ {ğ•Š: isOpen? IWS cf.window_mouse_passthrough ; mousePassThrough  }
  IsInterlacedhint    â‡ {ğ•Š: isOpen? IWS cf.window_interlacedhint    ; interlacedhint    }

  # window.stateNames
  stateNames â† [
    "                 "
    "fullscreen       "
    "resizable        "
    "undecorated      "
    "transparent      "
    "msaa4xhint       "
    "vsyncHint        "
    "hidden           "
    "runWhileMinimized"
    "minimized        "
    "maximized        "
    "unfocused        "
    "topmost          "
    "highDPI          "
    "mousePassThrough "
    "interlacedhint   "
    "interlacedhint   "
  ]
  # window.GetState
  GetState â† {ğ•¤ # returns binary list that corrisponds to raylib's config_flags format
    0â€¿fullscreenâ€¿resizableâ€¿(Â¬decorated)â€¿transparentâ€¿msaa_4x_hintâ€¿vsync_hintâ€¿hiddenâ€¿runWhileMinimizedâ€¿minimizedâ€¿maximizedâ€¿(Â¬focused)â€¿topmostâ€¿highdpiâ€¿mouse_passthroughâ€¿0â€¿interlaced_hint
  }
}

# Drawing
draw â† {
  âŸ¨
    _withCanvas_ â‹„ _in3D â‹„ _withinRectangle
    Rectangle â‹„ Triangle â‹„ Line
    Ellipse â‹„ EllipseOutline
    Text â‹„ Texture â‹„ advanced
  âŸ©â‡

  # Start 3d mode, drawing relative to camera using ğ”½, then ends 3d mode
  # draw._in3D
  _in3D â† {ğ•¨ Drawing3D _ğ•£ camera:
    NeedsWindow@          # pos  target up   FOV Camera projection type
    "_in3D: wrong types as input"!ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iii"â€¿"iii"â€¿"iii"â€¿'i'â€¿'i'
    raylib.BeginMode3D ğ•©
    raylib.EndMode3Dâˆ˜âŸ¨âŸ©âŠ¸âŠ¢ğ”½ğ•©
  }
  # Start drawing, draw background, use function ğ”½, end drawing
  # draw._withCanvas_
  _withCanvas_ â† {ğ•¨DrawingFunc _ğ•£_ Func_Returning_A_Colorğ•©:
    Start@
    Background ğ•¨ğ”¾ğ•©
    âŠ£âŸœEndğ•¨ğ”½ğ•©
  }

  # draw._onTexture
  {ğ”½ _ğ•£ texture:
    raylib.BeginTextureModeğ•©
    raylib.EndTextureModeâˆ˜âŸ¨âŸ©âŠ¸âŠ¢ ğ”½ğ•©
  }

  # draw._withinRectangle
  _withinRectangle â† {
    raylib.BeginScissorMode (âŠ£âˆ¾-Ëœ)Ëâˆ§Ë˜âŒ¾â‰i32_maxâŒŠ0âŒˆâŒŠğ•©
    raylib.EndScissorModeâˆ˜âŸ¨âŸ©âŠ¸âŠ¢ğ”½ğ•©
  }

  # Draw text at xâ€¿y in given font, color, and size
  # draw.Text
  Text â† {ğ•¨ğ•ŠâŸ¨xâ€¿yâ‹„textâŸ©:
    NeedsWindow@
    t â† âŸ¨râ€¿gâ€¿bâ€¿aâ‹„fontâ‹„fontSizeâ‹„spacingâŸ© â‡ âˆ¾âŸœ1âŸ(3â‰¡â‰ )ğ•¨
    "Text: wrong types as input"!tâ€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿("iii"âˆ¾(5â¥Š'i')â€¿'n'â€¿'n')â€¿'i'â€¿'i'â‹„"ii"â‹ˆ'c'Â¨textâŸ©
    raylib.DrawTextCodepoints âŸ¨fontâ‹„text-@â‹„â‰ textâ‹„xâ€¿yâ‹„fontSizeâ‹„spacingâ‹„râ€¿gâ€¿bâ€¿aâŸ©
  }

  # Draw line from x1â€¿y1 to x2â€¿y2
  # draw.Line
  Line â† {ğ•¨ğ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    leftArg â† {
      ğ•Šrâ€¿gâ€¿bâ€¿a:1â‹ˆËœğ•©;
      ğ•ŠâŸ¨râ€¿gâ€¿bâ€¿aâ‹„thicknessâŸ©:ğ•©
    }ğ•¨
    "Line: wrong types as input"!leftArgâ€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿'i'â‹„2â€¿2â¥Š'i'âŸ©
    raylib.DrawLineEx(<Ë˜ğ•©)âˆ¾âŒ½leftArg
  }

  # draw.Texture
  Texture â† {tintâ€¿textureâ€¿scaleâ€¿rotationğ•Šxâ€¿y:
    NeedsWindow@
    "Texture: wrong types as input"!âŸ¨tintâ‹„textureâ‹„scaleâ‹„rotationâŸ©â€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡âŸ¨"iiii"â€¿"iiiii"â€¿'i'â€¿'i'â‹„"ii"âŸ©
    raylib.DrawTextureEx âŸ¨textureâ‹„xâ€¿yâ‹„rotationâ‹„scaleâ‹„tintâŸ© # textureâ€¿v2â€¿fâ€¿fâ€¿color # texture position rotation scale tint
  }

  # draw.Rectangle
  Rectangle â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    "Rectangle: wrong types as input"!ğ•¨â€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iiii"â‹ˆ2â€¿2â¥Š'i'
    raylib.DrawRectangleV ğ•¨âˆ¾âŸœ<Ëœ(âŠ£â‹ˆ-Ëœ)Ëâˆ§Ë˜âŒ¾â‰i32_maxâŒŠ0âŒˆâŒŠğ•© # capping with max and min to avoid errors at âˆ
  }

  # draw.Ellipse
  Ellipse â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    ((âˆ§Â´âŒˆâŠ¸=âˆ¨âˆ=|)â¥Šğ•©)!Ëœ"Ellipse only accepts ints as args"
    ((âˆ§Â´0âŠ¸â‰¤âˆ§â‰¤âŸœ255)ğ•¨)!Ëœ"ğ•¨ (color) only accepts ints in the range 0-255 inclusive"
    raylib.DrawEllipse ğ•¨âˆ¾âŸœ<Ëœ(âŒˆâˆ¾âŠ¢-âŠâˆ˜ğ•©)(+ËÃ·â‰ )ğ•©
  }

  # Draw a color-filled circle
  # draw.Circle
  Circle â† {râ€¿gâ€¿bâ€¿ağ•ŠâŸ¨xâ€¿yâ‹„radiusâŸ©: # color ğ•Š posâ€¿radius
    NeedsWindow@
    (ğ•¨â€¿ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iiii"â€¿âŸ¨"ii"â‹„'i'âŸ©)!Ëœ"Wrong input types given to draw.Circle"
    ((âˆ§Â´âŒˆâŠ¸=âˆ¨âˆ=|)xâ€¿y)!Ëœ"Position for draw.Circle has to be two ints"
    ((âˆ§Â´0âŠ¸â‰¤âˆ§â‰¤âŸœ255)ğ•¨)!Ëœ"ğ•¨ (color) only accepts ints in the range 0-255 inclusive"
    raylib.DrawCircle xâ€¿yâ€¿radiusâ€¿ğ•¨
  }

  # draw.EllipseOutline
  EllipseOutline â† {râ€¿gâ€¿bâ€¿ağ•Š[x1â€¿y1â‹„x2â€¿y2]:
    NeedsWindow@
    raylib.DrawEllipseLines ğ•¨âˆ¾âŸœ<Ëœ(âŒˆâˆ¾âŠ¢-âŠâˆ˜ğ•©)(+ËÃ·â‰ )ğ•©                # iâ€¿iâ€¿fâ€¿fâ€¿color # centerX centerY radiusH radiusV
  }

  # draw.Triangle
  Triangle â† {colorğ•Š[x1â€¿y1â‹„x2â€¿y2â‹„x3â€¿y3]:
    [p1,p2,p3] â† ğ•©
    raylib.DrawTriangle p1â€¿ğ•¨âˆ¾Ëœp2â€¿p3âŒ½Ëœp3<â—‹(â€¢math.Atan2Â´p2âŠ¸-)p1
  }

  # Start Drawing
  Start â† {ğ•¤
    NeedsWindow@
    raylib.BeginDrawingâŸ¨âŸ©
  }
  # Draw background
  Background â† {ğ•Šrâ€¿gâ€¿bâ€¿a:
    NeedsWindow@
    (âˆ§Â´(255âŠ¸â‰¥âˆ§>0âŠ¸â‰¤)ğ•©)!Ëœ"ClearBackground only accepts ints in the range 0-255 inclusive"
    "Background: wrong types as input"!ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iiii"
    raylib.ClearBackground ğ•©
  }
  # End drawing
  End â† {ğ•¤
    NeedsWindow@
    raylib.EndDrawingâŸ¨âŸ©
  }
  # These aren't recommended because they are useless if you use _withCanvas_.
  # They also don't behave well if ran in the wrong order,
  # you only want to run them in the "start, background, end" sequence.
  advanced â‡ {Startâ€¿Backgroundâ€¿Endâ‡Startâ€¿Backgroundâ€¿End}
}

font â† {
  âŸ¨ Load â‹„ LoadBQN â‹„ LoadRaylib â‹„ Unload âŸ©â‡
  IsFont â† {
    (ğ•©â€¢TypeâŠ¸âŠ‘âŸœ"_icfmdn"âš‡0âŠ¸â‰¡"iii"âˆ¾"iiiii"<âŠ¸âˆ¾â‹ˆËœ'n')!Ëœ"Expected a valid font"
    ğ•©âŠ£(Â¬âˆ¨Â´low.IsNullÂ¨Â¯2â†‘ğ•©)!Ëœ"Invalid font. font has null pointers, making it invalid"
  }
  glyphInfo â† {valueâ€¿offsetXâ€¿offsetYâ€¿advanceXâ€¿imageâ‡â†•5}             # The namespace is for eliminating magic-numbers

  # font.Unload
  Unload â‡ {
    NeedsWindow@
    IsFont ğ•©
    raylib.UnloadFont ğ•©
  }
  # font.Load
  Load â‡ {
    NeedsWindow@
    F â† {
      ğ•Šsizeâ€¿filePath:
        âŸ¨filePathâ‹„sizeâ‹„â‰@â‹„0âŸ©
    ;                                           # fontSize fontChars glyphCount # use NULL for fontChars and 0 for glyphCount to load the default character set
      charactersAllowed ğ•Š sizeâ€¿filePath:
        âŸ¨filePathâ‹„sizeâ‹„ğ•¨-@â‹„â‰ ğ•¨âŸ©
    }
    Â·â€¿filePath â† ğ•©
    {!"Path given wasn't absolute ğ•©â‰¡"âˆ¾â€¢Reprğ•©}âŸ("."âŠ¸â€¢file.AtâŠ¸â‰¢)filePath
    {ğ•Š:!"Couldn't find file at "âˆ¾â€¢file.RealPath filePath}âŸÂ¬â€¢file.Exists filePath

    IsFont raylib.LoadFontEx ğ•¨Fğ•©
  }

  # font.LoadBQN
  LoadBQN â† {ğ•ŠfontSize: fontSize 100âŸ(@âŠ¸â‰¡)â†©
    NeedsWindow@
    file â† ("Expected file at: "âŠ¸âˆ¾!â€¢file.Exists)âŠ¸âŠ¢ FileAt"src/imports/BQN386/BQN386.ttf"
    raylib.LoadFontExâŸ¨fileâ‹„fontSizeâ‹„bqnFontChars-@â‹„â‰ bqnFontCharsâŸ©
  }
  # font.LoadRaylib
  LoadRaylib â† {ğ•Š@:
    raylib.GetFontDefaultâŸ¨âŸ©
  }
}
clipboard â† {
  âŸ¨Get â‹„ SetâŸ©â‡
  âŸ¨ToBytesâŸ© â† â€¢Import "src/imports/bqn-libs/strings.bqn"
  
  # clipboard.Get
  Get â‡ {ğ•¤
    NeedsWindow@
    low.IsNullâ—¶âŸ¨
      low.StrLenâŠ¸low.MakeUTF8
      ""
    âŸ© raylib.GetClipboardTextâŸ¨âŸ©
  }
  # clipboard.Set
  Set â‡ {ğ•Štext:
    NeedsWindow@
    raylib.SetClipboardText ToBytes ğ•©
  }
}

# start clock then tick at the start of every frame to get accurate clock.delta and clock.time
StartClock â† {ğ•Š@:
  âŸ¨startTime â‹„ Time â‹„ TickâŸ©â‡

  # time is relative to when you started the clock
  # clock.startTime
  startTime â‡ â€¢MonoTime@
  lastTime â† 0
  
  delta â‡ 0
  frame â‡ 0

  # clock.Time
  Time  â‡ {ğ•Š:startTime-Ëœâ€¢Monotime@}
  
  # clock.Tick
  Tick â‡ {ğ•Š:
    frame+â†©1
    delta â†© lastTime-ËœstartTime-Ëœâ€¢MonoTime@
    lastTime â†© startTime-Ëœâ€¢MonoTime@
    delta
  }
}

mouse â† {
  # mouse.GetPos
  GetPos     â‡ {ğ•¤
    NeedsWindow@
    raylib.GetMousePositionâŸ¨âŸ©
  }
  # mouse.WheelMoved
  WheelMoved â‡ {ğ•¤
    NeedsWindow@
    raylib.GetMouseWheelMoveâŸ¨âŸ©
  }
  # mouse.IsButtonDown
  IsButtonDown â‡ {
    NeedsWindow@
    "Mouse button doesn't exist. (ğ•©âˆŠâ†•7)"!âˆ¨Â´â¥Šğ•©âˆŠâ†•buttons
    raylib.IsMouseButtonDownâš‡0 ğ•©
  }
  buttons â† 7
  # mouse.button.
  button â‡ {
    leftâ€¿rightâ€¿middleâ€¿sideâ€¿extraâ€¿forwardâ€¿back â‡ â†•buttons
  }
  # mouse.cursor.
  cursor â‡ { # Mouse cursor
    default       â‡ 0   # Default pointer shape                                        
    arrow         â‡ 1   # Arrow shape                                                  
    ibeam         â‡ 2   # Text writing cursor shape                                    
    crosshair     â‡ 3   # Cross shape                                                  
    pointing_hand â‡ 4   # Pointing hand cursor                                         
    resize_ew     â‡ 5   # Horizontal resize/move arrow shape                           
    resize_ns     â‡ 6   # Vertical resize/move arrow shape                             
    resize_nwse   â‡ 7   # Top-left to bottom-right diagonal resize/move arrow shape    
    resize_nesw   â‡ 8   # The top-right to bottom-left diagonal resize/move arrow shape
    resize_all    â‡ 9   # The omnidirectional resize/move cursor shape                 
    not_allowed   â‡ 10  # The operation-not-allowed shape                              
  }
}

# Wave, audio wave data
sound â‡ {
  wave â‡ {
    âŸ¨LoadFromFile â‹„ Unload â‹„ _withFileâŸ©â‡

    # sound.wave.LoadFromFile
    LoadFromFile â‡ {ğ•ŠfilePath:
      {!"Path given wasn't absolute ğ•©â‰¡"âˆ¾â€¢Reprğ•©}âŸ("."âŠ¸â€¢file.AtâŠ¸â‰¢)ğ•©
      {ğ•Š:!"Couldn't find file at "âˆ¾â€¢file.RealPath filePath}âŸÂ¬â€¢file.Exists ğ•©
    
      bqnSound â† {
        freqâ€¿formatâ€¿bqnSound â† bqnoise.ReadFull filePath
        âŒŠâˆ˜Ã·âŸœ(2â‹†Â¯16+1âŠ‘format) bqnSound bqnoiseOptions.ResampleËœ freqâˆ¾bqnoiseOptions.freq
      }
      âŸ¨
        1âŠ‘â‰¢bqnSound   # frameCount
        bqnoiseOptions.freq  # sampleRate
        1âŠ‘bqnoiseOptions.fmt # sampleSize
        â‰ bqnSound     # channels
        { # *data
          data â† â¥Šâ‰bqnSound
          {â†•âˆ˜â‰ âŠ¸(ğ•©.WriteÂ¨) data}âŠ¸âŠ¢(raylib.MemAlloc 2Ã—â‰ data).Cast "i16"
        }
      âŸ©
    }

    # sound.wave.Unload
    Unload â‡ raylib.MemFree 4âŠ¸âŠ‘

    # sound.wave._withFile
    _withFile â‡ {(UnloadâŠ¢ğ”½)LoadFromFile}
  }

  # sound.FromFile
  FromFile â‡ raylib.LoadSoundFromWave wave._withFile # fileNameâ†’Sound
  
  # sound.Play
  Play â‡ raylib.PlaySound
  _withAudio â‡ {
    raylib.CloseAudioDeviceâˆ˜âŸ¨âŸ©âŠ¢ğ”½âŠ£raylib.InitAudioDeviceâˆ˜âŸ¨âŸ©
  }
}

key â† {
  
  # key.IsPressed
  IsPressed â‡ {ğ•Š key:
    raylib.IsKeyPressed @-ËœâŸ<ğ•©
  }âš‡0âŠ£NeedsWindow

  # key.IsDown
  IsDown â‡ {
    raylib.IsKeyDown @-ËœâŸ<ğ•©
  }âš‡0âŠ£NeedsWindow

  # Get key pressed as keycode
  # key.PressedKey
  PressedKey â‡ {ğ•¤
    NeedsWindow@
    raylib.GetKeyPressedâŸ¨âŸ©
  }

  # key.PressedChar
  PressedChar â‡ {ğ•¤
    NeedsWindow@
    @+raylib.GetcharPressedâŸ¨âŸ©
  }

  # Keyboard keys (US keyboard layout)
  # NOTE: Use GetKeyPressed() to allow redefining
  # required keys for alternative layouts

  # vars           Keycodes   Keys
  null          â‡ 0        # NULL, used for no key pressed
  
  # Alphanumeric keys
  apostrophe    â‡ 39       # '
  comma         â‡ 44       # ,
  minus         â‡ 45       # -
  period        â‡ 46       # .
  slash         â‡ 47       # /
  zero          â‡ 48       # 0
  one           â‡ 49       # 1
  two           â‡ 50       # 2
  three         â‡ 51       # 3
  four          â‡ 52       # 4
  five          â‡ 53       # 5
  six           â‡ 54       # 6
  seven         â‡ 55       # 7
  eight         â‡ 56       # 8
  nine          â‡ 57       # 9
  semicolon     â‡ 59       # ;
  equal         â‡ 61       # =
  a             â‡ 65       # A | a
  b             â‡ 66       # B | b
  c             â‡ 67       # C | c
  d             â‡ 68       # D | d
  e             â‡ 69       # E | e
  f             â‡ 70       # F | f
  g             â‡ 71       # G | g
  h             â‡ 72       # H | h
  i             â‡ 73       # I | i
  j             â‡ 74       # J | j
  k             â‡ 75       # K | k
  l             â‡ 76       # L | l
  m             â‡ 77       # M | m
  n             â‡ 78       # N | n
  o             â‡ 79       # O | o
  p             â‡ 80       # P | p
  q             â‡ 81       # Q | q
  r             â‡ 82       # R | r
  s             â‡ 83       # S | s
  t             â‡ 84       # T | t
  u             â‡ 85       # U | u
  v             â‡ 86       # V | v
  w             â‡ 87       # W | w
  x             â‡ 88       # X | x
  y             â‡ 89       # Y | y
  z             â‡ 90       # Z | z
  left_bracket  â‡ 91       # [
  backslash     â‡ 92       # \
  right_bracket â‡ 93       # ]
  grave         â‡ 96       # `
  
  # Function keys
  space         â‡ 32       # Space
  escape        â‡ 256      # Esc
  enter         â‡ 257      # Enter
  tab           â‡ 258      # Tab
  backspace     â‡ 259      # Backspace
  insert        â‡ 260      # Ins
  delete        â‡ 261      # Del
  right         â‡ 262      # Cursor right
  left          â‡ 263      # Cursor left
  down          â‡ 264      # Cursor down
  up            â‡ 265      # Cursor up
  page_up       â‡ 266      # Page up
  page_down     â‡ 267      # Page down
  home          â‡ 268      # Home
  end           â‡ 269      # End
  caps_lock     â‡ 280      # Caps lock
  scroll_lock   â‡ 281      # Scroll down
  print_screen  â‡ 283      # Print screen
  pause         â‡ 284      # Pause
  f1            â‡ 290      # F1
  f2            â‡ 291      # F2
  f3            â‡ 292      # F3
  f4            â‡ 293      # F4
  f5            â‡ 294      # F5
  f6            â‡ 295      # F6
  f7            â‡ 296      # F7
  f8            â‡ 297      # F8
  f9            â‡ 298      # F9
  f10           â‡ 299      # F10
  f11           â‡ 300      # F11
  f12           â‡ 301      # F12
  left_shift    â‡ 340      # Shift left
  left_control  â‡ 341      # Control left
  left_alt      â‡ 342      # Alt left
  left_super    â‡ 343      # Super left
  right_shift   â‡ 344      # Shift right
  right_control â‡ 345      # Control right
  right_alt     â‡ 346      # Alt right
  right_super   â‡ 347      # Super right
  kb_menu       â‡ 348      # KB menu

  keypad â‡ {
    num_lock    â‡ 282      # Num lock
    zero        â‡ 320      # Keypad 0
    one         â‡ 321      # Keypad 1
    two         â‡ 322      # Keypad 2
    three       â‡ 323      # Keypad 3
    four        â‡ 324      # Keypad 4
    five        â‡ 325      # Keypad 5
    six         â‡ 326      # Keypad 6
    seven       â‡ 327      # Keypad 7
    eight       â‡ 328      # Keypad 8
    nine        â‡ 329      # Keypad 9
    decimal     â‡ 330      # Keypad .
    divide      â‡ 331      # Keypad /
    multiply    â‡ 332      # Keypad *
    subtract    â‡ 333      # Keypad -
    add         â‡ 334      # Keypad +
    enter       â‡ 335      # Keypad Enter
    equal       â‡ 336      # Keypad =
  }
  android â‡ {
    back        â‡ 4        # back button
    menu        â‡ 82       # menu button
    volume_up   â‡ 24       # volume up button
    volume_down â‡ 25       # volume down button
  }
}